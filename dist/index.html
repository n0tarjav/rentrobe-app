<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rentrobe - Premium Fashion Rental</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='LOGO_W_TITLE.png') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* THEME OVERRIDES */
        :root {
            --theme-bg: #F0F7F5;
            --theme-surface: #E8F2F0;
            --theme-stroke: #D1E7DD;
            --theme-border: #A3D5C4;
            --theme-accent: #2F5249;
        }

        body {
            background: var(--theme-bg);
            color: #000000;
        }

        header {
            background: rgba(233, 233, 227, 0.95);
            border-bottom: 1px solid rgba(70, 79, 80, 0.08);
            box-shadow: 0 1px 3px rgba(70, 79, 80, 0.05);
        }

        header.scrolled {
            background: rgba(233, 233, 227, 0.98);
            box-shadow: 0 4px 30px rgba(70, 79, 80, 0.12);
            border-bottom: 1px solid rgba(70, 79, 80, 0.12);
        }

        .nav-links a {
            color: var(--theme-accent);
        }

        .nav-links a:hover {
            color: var(--theme-accent);
            background: transparent;
        }

        .nav-links a::after,
        .nav-links a.active::after {
            background: var(--theme-accent);
        }

        .nav-links a.active {
            color: var(--theme-accent);
        }

        .btn {
            border-color: var(--theme-accent);
            color: var(--theme-accent);
        }

        .btn::before { background: var(--theme-accent); }

        .btn-primary {
            background: var(--theme-accent);
            border-color: var(--theme-accent);
        }

        .btn-primary::before { background: var(--theme-accent); }

        .btn-primary:hover {
            background: var(--theme-accent);
            border-color: var(--theme-accent);
            box-shadow: 0 8px 25px rgba(70, 79, 80, 0.25);
        }

        .dropdown { background: var(--theme-surface); border-color: var(--theme-stroke); }
        .dropdown a { color: var(--theme-accent); }
        .dropdown a:hover { background: var(--theme-surface); color: var(--theme-accent); }
        .dropdown a::before { background: var(--theme-accent); }

        .search-input {
            background: var(--theme-surface);
            border-color: var(--theme-border);
        }
        .search-input:hover { border-color: var(--theme-accent); }
        .search-input:focus { border-color: var(--theme-accent); box-shadow: 0 0 0 3px rgba(70, 79, 80, 0.1); }
        .search-btn { background: var(--theme-accent); }
        .search-btn:hover { background: var(--theme-accent); }

        .section-title { color: #000000; }

        .categories-grid .category-card,
        .filters,
        .item-card,
        .modal-content {
            background: var(--theme-surface);
            border-color: var(--theme-stroke);
        }

        .category-card:hover,
        .item-card:hover,
        .filters:hover { border-color: var(--theme-accent); }

        .item-image,
        .image-fallback,
        .item-size { background: var(--theme-surface); }
        .image-fallback { color: var(--theme-accent); }

        .item-title,
        .item-price { color: #000000; }

        .owner-avatar { background: var(--theme-border); }
        .item-card:hover .owner-avatar { background: var(--theme-accent); }

        .modal { background: rgba(70, 79, 80, 0.5); }
        .modal-close:hover { color: var(--theme-accent); background: var(--theme-surface); }

        .form-input { background: var(--theme-surface); border-color: var(--theme-border); }
        .form-input:hover { border-color: var(--theme-accent); }
        .form-input:focus { border-color: var(--theme-accent); box-shadow: 0 0 0 3px rgba(70, 79, 80, 0.1); }

        .file-upload { border-color: var(--theme-border); }
        .file-upload:hover { border-color: var(--theme-accent); background: var(--theme-surface); }

        footer { background: var(--theme-accent); color: #ffffff; }
        .footer-content h4 { color: #ffffff; }
        .footer-content p { color: #ffffff; }
        footer a { color: #ffffff; text-decoration: none; }
        footer a:hover { color: var(--theme-surface); }

        .mobile-menu-toggle { color: var(--theme-accent); }

        :root {
            --black: #2F5249; /* primary text/accents -> theme-accent */
            --white: #F0F7F5; /* background -> theme-bg */
            --gray-100: #E8F2F0; /* light surfaces -> theme-surface */
            --gray-200: #D1E7DD; /* strokes -> theme-stroke */
            --gray-300: #A3D5C4; /* subtle borders -> theme-border */
            --gray-500: #2F5249; /* map grays to accent */
            --gray-600: #2F5249;
            --gray-800: #2F5249;
            --success: #22c55e;
            --error: #ef4444;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--black);
            background: var(--white);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }


        header.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.12);
            border-bottom: 1px solid rgba(0, 0, 0, 0.12);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            min-height: 60px;
        }

        .logo {
            font-size: 26px;
            font-weight: 800;
            color: var(--black);
            text-decoration: none;
            letter-spacing: -0.5px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
        }

        /*.logo img {
             No transitions for static logo 
        }*/

        .logo:hover {
            color: var(--gray-800);
        }

        /* Underline animation removed for logo */

        .nav-links {
            display: flex;
            gap: 48px;
            list-style: none;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--gray-600);
            font-weight: 600;
            font-size: 16px;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 12px 16px;
            border-radius: 8px;
        }

        .nav-links a:hover {
            color: var(--black);
            background: transparent;
            transform: translateY(-2px);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            height: 2px;
            width: 100%;
            background: var(--black);
            transform: scaleX(0);
            transform-origin: right center; /* collapse toward right by default */
            transition: transform 0.3s ease;
            will-change: transform;
        }

        .nav-links a:hover::after {
            transform: scaleX(1);
            transform-origin: left center; /* expand from left on hover */
        }

        .nav-links a.active {
            color: var(--black);
            font-weight: 500;
        }

        .nav-links a.active::after {
            transform: scaleX(1);
            transform-origin: left center;
        }

        .btn {
            padding: 12px 24px;
            border: 1px solid var(--black);
            background: transparent;
            color: var(--black);
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            display: inline-block;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--black);
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .btn:hover {
            color: var(--white) !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn:hover::before {
            left: 0;
        }

        .btn-primary {
            background: var(--black);
            color: var(--white);
            border-color: var(--black);
        }

        .btn-primary::before {
            background: var(--gray-800);
        }

        .btn-primary:hover {
            background: var(--gray-800);
            border-color: var(--gray-800);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
        }

        .auth-buttons {
            display: flex;
            gap: 12px;
            align-items: center;
        }


        /* User Menu */
        .user-menu {
            position: relative;
            display: none; /* shown as flex when logged in */
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--black), var(--gray-800));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
        }

        .user-avatar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--gray-600), var(--black));
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: 50%;
            z-index: -1;
        }

        .user-avatar:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .user-avatar:hover::before {
            opacity: 1;
        }

        .user-avatar:active {
            transform: scale(1.05) translateY(-1px);
        }

        .dropdown {
            position: absolute;
            top: calc(100% + 10px);
            right: 0;
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            min-width: 160px;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .dropdown.show {
            display: block;
        }

        .dropdown a {
            display: block;
            padding: 12px 16px;
            color: var(--gray-600);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
            position: relative;
        }

        .dropdown a::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: var(--black);
            transform: scaleY(0);
            transition: transform 0.2s ease;
        }

        .dropdown a:hover {
            background: var(--gray-100);
            color: var(--black);
            padding-left: 20px;
        }

        .dropdown a:hover::before {
            transform: scaleY(1);
        }

        /* Main Content */
        main {
            margin-top: 0;
            min-height: 100vh;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            background: #202020;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        /* Hero Carousel */
        .hero-carousel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .carousel-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .carousel-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .carousel-slide.active {
            opacity: 1;
        }

        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            opacity: 1;
        }

        .carousel-slide::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            opacity: 0.6;
            z-index: 1;
        }


        .hero-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
        }

        .hero-text {
            color: white;
        }

        .hero-text h1 {
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            color: white;
        }

        .hero-text p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            line-height: 1.6;
        }

        .hero-visual {
            position: relative;
            height: 500px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .hero-image-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
            height: 100%;
            padding: 20px;
        }

        .hero-image {
            width: 100%;
            height: 100%;
            border-radius: 15px;
            object-fit: cover;
            transition: transform 0.3s ease, opacity 0.3s ease;
            cursor: pointer;
        }

        .hero-image:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }

        .hero-image-large {
            grid-column: 1 / -1;
            height: 200px;
        }

        .hero-image-small {
            height: 140px;
        }

        /* Floating Fashion Items */
        .floating-items {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 0;
        }

        .floating-item {
            position: absolute;
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: float 6s ease-in-out infinite;
        }

        .floating-item:nth-child(1) {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .floating-item:nth-child(2) {
            top: 60%;
            right: 15%;
            animation-delay: 2s;
        }

        .floating-item:nth-child(3) {
            bottom: 20%;
            left: 20%;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg); 
                opacity: 0.7;
            }
            50% { 
                transform: translateY(-20px) rotate(180deg); 
                opacity: 1;
            }
        }


        /* Sections */
        .section {
            padding: 60px 0;
        }

        /* Reduce padding for How It Works section */
        .section:has(.how-it-works) {
            padding-bottom: 40px;
        }

        .section-title {
            font-size: 36px;
            font-weight: 800;
            text-align: center;
            margin-bottom: 60px;
            color: var(--black);
            letter-spacing: -1px;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(135deg, var(--theme-primary), #4a7c59);
            border-radius: 2px;
        }

        /* Rentrobe text hover animation - More specific and direct */
        h2.section-title .rentrobe-text {
            position: relative;
            display: inline-block;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        h2.section-title .rentrobe-text::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            height: 2px;
            width: 100%;
            background: #2F5249;
            transform: scaleX(0);
            transform-origin: right center;
            transition: transform 0.3s ease;
        }

        h2.section-title .rentrobe-text:hover {
            color: #2F5249 !important;
            background-color: rgba(47, 82, 73, 0.1);
            padding: 2px 4px;
            border-radius: 4px;
        }

        h2.section-title .rentrobe-text:hover::after {
            transform: scaleX(1) !important;
            transform-origin: left center;
        }

        .legal-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.7;
            color: var(--gray-700);
        }

        .legal-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--black);
            margin: 2.5rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--theme-accent);
        }

        .legal-content h4 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--gray-800);
            margin: 1.5rem 0 0.75rem 0;
        }

        .legal-content p {
            margin-bottom: 1.25rem;
            font-size: 1rem;
        }

        .legal-content ul {
            margin: 1rem 0 1.5rem 0;
            padding-left: 1.5rem;
        }

        .legal-content li {
            margin-bottom: 0.5rem;
            position: relative;
        }

        .legal-content li::marker {
            color: var(--theme-accent);
        }

        .legal-content strong {
            color: var(--black);
            font-weight: 600;
        }


        /* Categories */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .category-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid #e2e8f0;
            padding: 48px 32px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 16px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.05), transparent);
            transition: left 0.6s ease;
        }

        .category-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            transform: translateY(-4px);
            border-color: var(--black);
        }

        .category-card:hover::before {
            left: 100%;
        }

        .category-card:hover .category-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .category-icon {
            font-size: 40px;
            margin-bottom: 20px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-block;
        }

        .category-card h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #1a202c;
        }

        .category-card p {
            color: #64748b;
            font-size: 15px;
            font-weight: 500;
        }

        /* Items Grid */
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }

        .item-card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .item-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.05));
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
            border-radius: 8px;
        }

        .item-card:hover {
            animation: subtleGlow 2s ease-in-out infinite;
            transform: translateY(-6px);
            border-color: var(--black);
        }

        .item-card:hover::before {
            opacity: 1;
        }

        .item-card:hover .item-image {
            animation: gentlePulse 3s ease-in-out infinite;
        }

        .item-card:hover .item-title {
            color: var(--black);
        }

        .item-card:hover .item-content {
            animation: contentFloat 2.5s ease-in-out infinite;
        }

        /* Filters and Sorting Styles */
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filters {
            background: var(--white);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--black);
            font-size: 14px;
        }

        .form-input {
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--black);
            box-shadow: 0 0 0 3px rgba(0,0,0,0.1);
        }

        .form-input:hover {
            border-color: var(--gray-300);
        }


        /* Looping animation keyframes */
        @keyframes gentlePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @keyframes subtleGlow {
            0% { box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15); }
            50% { box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25); }
            100% { box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15); }
        }

        @keyframes contentFloat {
            0% { transform: translateY(-2px); }
            50% { transform: translateY(-4px); }
            100% { transform: translateY(-2px); }
        }

        @keyframes statusBounce {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes imageCycle {
            0% { opacity: 1; }
            25% { opacity: 1; }
            50% { opacity: 0; }
            75% { opacity: 0; }
            100% { opacity: 1; }
        }

        @keyframes imageCycleReverse {
            0% { opacity: 0; }
            25% { opacity: 0; }
            50% { opacity: 1; }
            75% { opacity: 1; }
            100% { opacity: 0; }
        }

        .item-image {
            width: 100%;
            aspect-ratio: 1 / 1;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-500);
            font-size: 32px;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .item-image .hover-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1.2s ease-in-out 0.6s;
            object-fit: cover;
        }

        .item-card:hover .item-image .hover-image {
            animation: imageCycleReverse 8s ease-in-out infinite;
        }

        .item-image .default-image {
            transition: opacity 0.3s ease-in-out 0.1s;
        }

        .item-card:hover .item-image .default-image {
            animation: imageCycle 8s ease-in-out infinite;
        }

        /* Reset transitions when not hovering - fast exit */
        .item-card:not(:hover) .item-image .hover-image {
            transition: opacity 0.3s ease-in-out 0.1s;
            animation: none;
        }

        .item-card:not(:hover) .item-image .default-image {
            transition: opacity 0.3s ease-in-out 0.1s;
            animation: none;
        }

        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        /* (removed) compact add-to-cart control */

        .image-fallback {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: var(--gray-100);
            color: var(--gray-500);
            font-size: 32px;
        }

        .item-status {
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--success);
            color: white;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: 500;
            border-radius: 4px;
            transition: all 0.3s ease;
            z-index: 3;
        }

        .item-card:hover .item-status {
            animation: statusBounce 1.5s ease-in-out infinite;
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.3);
        }

        .item-content {
            padding: 20px;
            transition: all 0.3s ease;
        }

        .item-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--black);
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }

        .item-description {
            color: var(--gray-600);
            font-size: 14px;
            margin-bottom: 16px;
        }

        .item-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .item-price {
            font-size: 16px;
            font-weight: 500;
            color: var(--black);
        }

        .item-size {
            background: var(--gray-100);
            padding: 2px 8px;
            font-size: 12px;
            color: var(--gray-600);
            border-radius: 4px;
        }

        .item-owner {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--gray-600);
        }

        .owner-avatar {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--gray-300);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: all 0.3s ease;
        }

        .item-card:hover .owner-avatar {
            transform: scale(1.1);
            background: var(--black);
            color: white;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .modal-content {
            background: var(--white);
            margin: 5% auto;
            padding: 40px;
            max-width: 500px;
            max-height: 90vh;
            border-radius: 8px;
            position: relative;
            overflow-y: auto;
        }

        .modal-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 20px;
            cursor: pointer;
            color: var(--gray-500);
            transition: all 0.3s ease;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .modal-close:hover {
            color: var(--black);
            background: var(--gray-100);
            transform: scale(1.1);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 400;
            margin-bottom: 24px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--black);
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--gray-300);
            border-radius: 4px;
            outline: none;
            font-size: 14px;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .form-input:focus {
            border-color: var(--black);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        .form-input:hover {
            border-color: var(--gray-500);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Filters */
        .filters {
            background: var(--white);
            border: 1px solid var(--gray-200);
            padding: 24px;
            margin-bottom: 40px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .filters:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-color: var(--gray-300);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        /* Alerts */
        .alert {
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }

        .alert-success {
            background: #f0fdf4;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        .alert-error {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        /* Loading */
        .spinner {
            display: none;
            width: 16px;
            height: 16px;
            border: 2px solid var(--gray-300);
            border-top: 2px solid var(--black);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        .password-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .password-input-wrapper .form-input {
            padding-right: 45px;
            width: 100%;
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            color: var(--gray-500);
        }

        .password-toggle:hover {
            color: var(--black);
            background: var(--gray-100);
        }

        .password-toggle:active {
            transform: translateY(-50%) scale(0.95);
        }

        .eye-icon {
            width: 20px;
            height: 20px;
            transition: all 0.2s ease;
        }

        .password-toggle:hover .eye-icon {
            transform: scale(1.1);
        }

        .password-toggle.visible .eye-icon {
            color: var(--black);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: var(--theme-accent);
            color: #ffffff;
            padding: 60px 0 40px;
            margin-top: 80px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }

        .footer-brand {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .footer-brand-logo {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin: 0;
            padding: 0;
        }

        .footer-brand-logo img {
            height: 32px;
            width: auto;
            max-width: 220px;
            margin: 0;
            padding: 0;
            display: inline-block;
            vertical-align: middle;
        }

        .footer-address {
            color: #ffffff;
            line-height: 1.6;
            font-size: 14px;
        }

        .footer-contact {
            margin-top: 20px;
        }

        .footer-contact-item {
            display: flex;
            flex-direction: column;
            margin-bottom: 12px;
        }

        .footer-contact-label {
            font-size: 12px;
            color: #cccccc;
            margin-bottom: 4px;
        }

        .footer-contact-value {
            font-size: 14px;
            color: #ffffff;
        }

        .footer-column h4 {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 20px;
        }

        .footer-links {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: #ffffff;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #cccccc;
        }

        .footer-bottom {
            margin-top: 40px;
            padding-top: 30px;
        }

        .footer-bottom .footer-content {
            display: block;
            text-align: center;
        }

        .footer-bottom-text {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
        }

        .footer-bottom-text p {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
                text-align: center;
            }
        }

        /* Page sections */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Add extra space for all main pages */
        #browse .section,
        #list .section,
        #cart .section,
        #my-items .section,
        #rentals .section {
            padding-top: 100px;
        }

        /* How It Works Section */
        .how-it-works {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 40px;
            margin-bottom: 10px;
            position: relative;
        }

        .how-it-works::before {
            content: '';
            position: absolute;
            top: -20px;
            left: -20px;
            right: -20px;
            bottom: -20px;
            background: linear-gradient(135deg, rgba(47, 82, 73, 0.02), rgba(74, 124, 89, 0.02));
            border-radius: 24px;
            z-index: -1;
        }

        .step {
            text-align: center;
            position: relative;
            padding: 30px 20px;
            border-radius: 16px;
            background: var(--white);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid var(--gray-100);
        }

        .step:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            border-color: var(--theme-primary);
        }

        .step:hover h3 {
            color: var(--theme-primary);
        }

        .step:hover p {
            color: var(--gray-700);
        }

        .step-icon {
            width: 90px;
            height: 90px;
            margin: 0 auto 25px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--white);
            border: 3px solid var(--theme-primary);
            border-radius: 50%;
            font-size: 36px;
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(47, 82, 73, 0.15);
            position: relative;
            overflow: hidden;
        }

        .step-icon svg {
            color: var(--theme-primary);
            transition: all 0.3s ease;
            opacity: 1;
            visibility: visible;
            display: block;
            position: relative;
            z-index: 2;
        }

        .step:hover .step-icon {
            background: var(--white);
            border-color: var(--theme-primary);
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 35px rgba(47, 82, 73, 0.4);
        }

        .step:hover .step-icon svg {
            color: var(--theme-primary);
            opacity: 1;
            visibility: visible;
        }

        .step h3 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--black);
            letter-spacing: -0.5px;
        }

        .step p {
            color: var(--gray-600);
            line-height: 1.7;
            font-size: 15px;
            font-weight: 400;
        }

        /* Progress Indicators */
        .progress-indicators {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 60px;
            padding: 0 20px;
        }

        .progress-line {
            position: absolute;
            top: 50%;
            left: 15%;
            right: 15%;
            height: 6px;
            background: linear-gradient(90deg, var(--gray-200), var(--theme-primary), var(--gray-200));
            border-radius: 3px;
            z-index: 1;
            transform: translateY(-50%);
        }

        .progress-dot {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--theme-primary), #4a7c59);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            position: relative;
            z-index: 2;
            margin: 0 15px;
            transition: all 0.4s ease;
            box-shadow: 0 4px 15px rgba(47, 82, 73, 0.3);
            border: 3px solid var(--white);
        }

        .progress-dot:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(47, 82, 73, 0.4);
        }

        .progress-dot::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--theme-primary), #4a7c59);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .progress-dot:hover::before {
            opacity: 1;
        }

        /* Responsive Design for How It Works */
        @media (max-width: 768px) {
            .how-it-works {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .step-icon {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
            
            .progress-dot {
                width: 40px;
                height: 40px;
                font-size: 16px;
                margin: 0 8px;
            }
            
            .progress-line {
                left: 10%;
                right: 10%;
            }
        }

        /* Pagination Styles */
        .pagination-container {
            margin-top: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .pagination {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--theme-surface);
            padding: 12px;
            border-radius: 12px;
            border: 1px solid var(--theme-stroke);
            box-shadow: 0 2px 8px rgba(70, 79, 80, 0.08);
        }

        .pagination-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border: 1px solid var(--theme-border);
            background: var(--theme-surface);
            color: var(--theme-accent);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            font-weight: 600;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--theme-accent);
            color: white;
            border-color: var(--theme-accent);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(70, 79, 80, 0.2);
        }

        .pagination-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: var(--theme-surface);
            color: var(--theme-border);
        }

        .pagination-numbers {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .pagination-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border: 1px solid var(--theme-border);
            background: var(--theme-surface);
            color: var(--theme-accent);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 14px;
        }

        .pagination-number:hover {
            background: var(--theme-accent);
            color: white;
            border-color: var(--theme-accent);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(70, 79, 80, 0.2);
        }

        .pagination-number.active {
            background: var(--theme-accent);
            color: white;
            border-color: var(--theme-accent);
            box-shadow: 0 2px 8px rgba(70, 79, 80, 0.25);
        }

        .pagination-ellipsis {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            color: var(--theme-accent);
            font-weight: 600;
            opacity: 0.6;
        }

        .pagination-info {
            color: var(--theme-accent);
            font-size: 14px;
            font-weight: 500;
            opacity: 0.8;
            text-align: center;
        }

        /* Mobile pagination adjustments */
        @media (max-width: 768px) {
            .pagination {
                padding: 8px;
                gap: 4px;
            }
            
            .pagination-btn,
            .pagination-number {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }
            
            .pagination-btn {
                font-size: 16px;
            }
            
            .pagination-container {
                margin-top: 30px;
                gap: 15px;
            }
        }

        /* Mobile Navigation */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--black);
            padding: 8px;
            z-index: 1001;
            position: relative;
            min-width: 40px;
            min-height: 40px;
            pointer-events: auto;
            user-select: none;
        }

        .mobile-menu-toggle:hover {
            background: var(--gray-100);
            border-radius: 4px;
        }

        .mobile-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-top: 1px solid var(--gray-200);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            overflow-y: auto;
            transform: translateY(-100%);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
            visibility: hidden;
            padding-top: 50px;
        }

        .mobile-nav.active {
            transform: translateY(0) !important;
            opacity: 1 !important;
            visibility: visible !important;
            display: block !important;
        }

        .mobile-nav-links {
            list-style: none;
            padding: 20px 0;
            margin: 0;
        }

        .mobile-nav-links li {
            margin: 0;
        }

        .mobile-nav-links a {
            display: block;
            padding: 16px 24px;
            color: var(--gray-600);
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            transition: all 0.3s ease;
            border-bottom: 1px solid var(--gray-100);
        }

        .mobile-nav-links a:hover {
            background: var(--gray-100);
            color: var(--black);
        }

        .mobile-nav-links a.active {
            background: var(--gray-100);
            color: var(--black);
            font-weight: 600;
        }


        .mobile-user-section {
            padding: 20px 24px;
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-100);
        }

        .mobile-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .mobile-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gray-600);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .mobile-user-details {
            flex: 1;
        }

        .mobile-user-name {
            font-weight: 600;
            color: var(--black);
            font-size: 16px;
        }

        .mobile-user-email {
            color: var(--gray-600);
            font-size: 14px;
        }

        .mobile-user-menu {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .mobile-user-menu a {
            display: block;
            padding: 12px 16px;
            color: var(--gray-600);
            text-decoration: none;
            font-weight: 500;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .mobile-user-menu a:hover {
            background: var(--gray-100);
            color: var(--black);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-toggle {
                display: block;
            }
            
            .user-menu {
                display: none;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 12px;
            }

            nav {
                padding: 8px 0;
                min-height: 50px;
                position: relative;
                z-index: 1002;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            .logo {
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1003;
            }

            .logo img {
                height: 30px;
            }

            .auth-buttons {
                display: flex;
                gap: 8px;
                position: absolute;
                left: 16px;
                top: 50%;
                transform: translateY(-50%);
                z-index: 1004;
            }

            .mobile-menu-toggle {
                position: absolute;
                right: 16px;
                top: 50%;
                transform: translateY(-50%);
                z-index: 1005;
            }
            
            .hero-content {
                text-align: center;
            }
            
            .hero-text h1 {
                font-size: 2.5rem;
            }
            
            .hero-text p {
                font-size: 1rem;
                margin-bottom: 2rem;
            }
            
            .hero-visual {
                height: 300px;
            }
            
            .floating-items {
                display: none;
            }
            
            
            .carousel-nav {
                padding: 0 10px;
            }
            
            .carousel-prev,
            .carousel-next {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .carousel-indicators {
                bottom: 20px;
            }
            
            .indicator {
                width: 10px;
                height: 10px;
            }
            
            .items-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .modal-content {
                margin: 5% 20px;
                padding: 24px;
                max-width: calc(100vw - 40px);
            }
            
            .main-image {
                aspect-ratio: 1 / 1 !important;
            }
        }

        @media (max-width: 480px) {
            .hero-text h1 {
                font-size: 2rem;
            }
            
            .hero-text p {
                font-size: 0.9rem;
                margin-bottom: 1.5rem;
            }
            
            .hero-visual {
                height: 250px;
            }
            
            .hero-image-grid {
                padding: 15px;
                gap: 8px;
            }
            
            
            .categories-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .category-card {
                padding: 24px 16px;
            }
            
            .browse-container {
                flex-direction: column;
                padding: 20px 15px;
            }
            
            .browse-sidebar {
                width: 100%;
                position: static;
                margin-bottom: 20px;
            }
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed var(--gray-300);
            padding: 20px;
            text-align: center;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .file-upload::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.05), transparent);
            transition: left 0.6s ease;
        }

        .file-upload:hover {
            border-color: var(--black);
            background: var(--gray-100);
            transform: translateY(-2px);
        }

        .file-upload:hover::before {
            left: 100%;
        }

        .file-upload input {
            display: none;
        }

        /* Image Gallery Styles */
        .image-gallery {
            position: relative;
        }

        .main-image {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            aspect-ratio: 1 / 1;
        }

        .main-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .main-image:hover img {
            transform: scale(1.02);
        }

        .thumbnail-gallery {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 4px 0;
        }

        .thumbnail-gallery img {
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .thumbnail-gallery img:hover {
            transform: scale(1.05);
        }

        /* Loading state for images */
        .item-image img[src=""] {
            display: none;
        }

        .item-image img:not([src]) {
            display: none;
        }

        /* View More Button */
        .view-more-container {
            text-align: center;
            margin-top: 40px;
        }

        .view-more-btn {
            padding: 12px 32px;
            font-size: 16px;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .view-more-btn::after {
            content: '';
            margin-left: 8px;
            transition: transform 0.3s ease;
        }

        .view-more-btn:hover::after {
            transform: translateX(4px);
        }

        /* Resources Page Styles */
        .resources-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .resource-section {
            margin-bottom: 60px;
        }

        .resource-section h3 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 30px;
            color: var(--black);
        }

        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .resource-card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-color: var(--black);
        }

        .resource-card h4 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--black);
        }

        .resource-card p {
            color: var(--gray-600);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .help-links {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .help-link {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
        }

        .help-link:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--black);
        }

        .help-icon {
            font-size: 32px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gray-100);
            border-radius: 50%;
        }

        .help-link h4 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--black);
        }

        .help-link p {
            color: var(--gray-600);
            margin: 0;
        }

        /* About Us Page Styles */
        .about-content {
            max-width: 1000px;
            margin: 0 auto;
        }

        .about-hero {
            text-align: center;
            margin-bottom: 60px;
        }

        .about-hero h3 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--black);
        }

        .about-intro {
            font-size: 18px;
            line-height: 1.8;
            color: var(--gray-600);
            max-width: 800px;
            margin: 0 auto;
        }

        .about-sections {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        .about-section h4 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--black);
        }

        .about-section p {
            font-size: 16px;
            line-height: 1.7;
            color: var(--gray-600);
            margin-bottom: 20px;
        }

        .values-list {
            list-style: none;
            padding: 0;
        }

        .values-list li {
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-200);
            font-size: 16px;
            line-height: 1.6;
        }

        .values-list li:last-child {
            border-bottom: none;
        }

        .values-list strong {
            color: var(--black);
            font-weight: 600;
        }

        /* FAQ Page Styles */
        .faq-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .faq-section {
            margin-bottom: 50px;
        }

        .faq-section h3 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            color: var(--black);
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 10px;
        }

        .faq-item {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .faq-question {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .faq-question:hover {
            background: var(--gray-50);
        }

        .faq-question h4 {
            font-size: 16px;
            font-weight: 500;
            margin: 0;
            color: var(--black);
        }

        .faq-toggle {
            font-size: 20px;
            font-weight: 300;
            color: var(--gray-500);
            transition: transform 0.3s ease;
        }

        .faq-item.active .faq-toggle {
            transform: rotate(45deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .faq-item.active .faq-answer {
            max-height: 200px;
        }

        .faq-answer p {
            padding: 0 20px 20px 20px;
            margin: 0;
            color: var(--gray-600);
            line-height: 1.6;
        }

        /* Contact Us Page Styles */
        .contact-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }

        .contact-card {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .contact-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-color: var(--black);
        }

        .contact-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .contact-card h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--black);
        }

        .contact-card p {
            color: var(--gray-600);
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .contact-card p:last-child {
            margin-bottom: 0;
            font-size: 14px;
            color: var(--gray-500);
        }

        .contact-form-section {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 40px;
        }

        .contact-form-section h3 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            color: var(--black);
            text-align: center;
        }

        .contact-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .contact-form .form-group {
            margin-bottom: 20px;
        }

        .contact-form .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--black);
        }

        .contact-form .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .contact-form .form-input:focus {
            outline: none;
            border-color: var(--black);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }

        .contact-form textarea {
            resize: vertical;
            min-height: 120px;
        }

        .contact-form .btn {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .resource-grid {
                grid-template-columns: 1fr;
            }

            .help-link {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .contact-info {
                grid-template-columns: 1fr;
            }

            .about-hero h3 {
                font-size: 28px;
            }

            .about-intro {
                font-size: 16px;
            }
        }

        /* Browse Page Sidebar Layout */
        .browse-container {
            display: flex;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 20px 40px 20px;
        }

        .browse-sidebar {
            width: 320px;
            background: linear-gradient(135deg, var(--white) 0%, #f8fffe 100%);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 8px 32px rgba(47, 82, 73, 0.12);
            height: fit-content;
            position: sticky;
            top: 100px;
            border: 1px solid rgba(47, 82, 73, 0.1);
        }

        .sidebar-title {
            font-size: 24px;
            font-weight: 800;
            color: var(--theme-primary);
            margin-bottom: 32px;
            text-align: center;
            position: relative;
            letter-spacing: -0.5px;
        }

        .sidebar-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(135deg, var(--theme-primary), #4a7c59);
            border-radius: 2px;
        }

        .sidebar-section {
            margin-bottom: 28px;
            padding: 20px;
            background: rgba(47, 82, 73, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(47, 82, 73, 0.08);
        }

        .sidebar-section .form-group {
            margin-bottom: 20px;
        }

        .sidebar-section .form-group:last-child {
            margin-bottom: 0;
        }

        .sidebar-section .form-label {
            font-weight: 600;
            color: var(--theme-primary);
            margin-bottom: 8px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-section .form-input {
            border: 2px solid rgba(47, 82, 73, 0.15);
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .sidebar-section .form-input:focus {
            border-color: var(--theme-primary);
            box-shadow: 0 0 0 3px rgba(47, 82, 73, 0.1);
            outline: none;
        }

        .sidebar-actions {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 8px;
        }

        .sidebar-actions .btn {
            width: 100%;
            text-align: center;
            padding: 14px 20px;
            font-weight: 600;
            border-radius: 10px;
            font-size: 15px;
            background: var(--white);
            border: 2px solid rgba(47, 82, 73, 0.2);
            color: var(--theme-primary);
        }

        .browse-main {
            flex: 1;
            min-width: 0;
        }

        .browse-main .section-title {
            margin-bottom: 30px;
            text-transform: none !important;
        }

        /* Loading optimization */
        .items-grid {
            min-height: 400px;
        }

        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 18px;
            color: var(--theme-primary);
        }

        .loading-spinner::after {
            content: '';
            width: 20px;
            height: 20px;
            border: 2px solid var(--theme-primary);
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Force Rentrobe hover animation - Highest priority */
        .section-title.rentrobe-text {
            position: relative !important;
            display: inline-block !important;
            cursor: pointer !important;
            transition: color 0.3s ease !important;
            text-align: center !important;
            margin: 0 auto 60px auto !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
        }

        .section-title.rentrobe-text::after {
            content: '' !important;
            position: absolute !important;
            bottom: -15px !important;
            left: 0 !important;
            width: 100% !important;
            height: 4px !important;
            background: #2F5249 !important;
            border-radius: 2px !important;
            transform: scaleX(0) !important;
            transform-origin: left center !important;
            transition: transform 0.3s ease !important;
        }

        .section-title.rentrobe-text:hover {
            color: #2F5249 !important;
        }

        .section-title.rentrobe-text:hover::after {
            transform: scaleX(1) !important;
            transform-origin: left center !important;
        }

        .section-title.rentrobe-text:not(:hover)::after {
            transform: scaleX(0) !important;
            transform-origin: right center !important;
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <a href="#" class="logo" onclick="showPage('home')">
                <img src="/static/LOGO.png" alt="Rentrobe" style="height: 35px; width: auto;">
            </a>
            <ul class="nav-links">
                <li><a href="#" onclick="showPage('home')" class="active">Home</a></li>
                <li><a href="#" onclick="showPage('browse')">Browse</a></li>
                <li><a href="#" onclick="showPage('list')" id="listItemLink">List Item</a></li>
                <li><a href="#" onclick="showPage('cart')" id="cartLink">My Cart</a></li>
            </ul>
            <div class="auth-buttons" id="authButtons">
                <a href="#" class="btn" onclick="showModal('loginModal')">Sign In</a>
                <a href="#" class="btn btn-primary" onclick="showModal('signupModal')">Join</a>
            </div>
            <div class="user-menu" id="userMenu">
                <div class="user-avatar" onclick="toggleUserMenu()">
                    <span id="userInitial">U</span>
                </div>
                <div class="dropdown" id="userDropdown">
                    <a href="#" onclick="showPage('profile')">Profile</a>
                    <a href="#" onclick="showPage('my-items')">My Items</a>
                    <a href="#" onclick="logout()">Sign Out</a>
                </div>
            </div>
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()"></button>
        </nav>
        
        <!-- Mobile Navigation -->
        <div class="mobile-nav" id="mobileNav">
            <!-- User Section -->
            <div class="mobile-user-section" id="mobileUserSection" style="display: none;">
                <div class="mobile-user-info">
                    <div class="mobile-user-avatar">
                        <span id="mobileUserInitial">U</span>
                    </div>
                    <div class="mobile-user-details">
                        <div class="mobile-user-name" id="mobileUserName">User Name</div>
                        <div class="mobile-user-email" id="mobileUserEmail">user@example.com</div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation Links -->
            <ul class="mobile-nav-links">
                <li><a href="#" onclick="showPage('home'); closeMobileMenu();" class="active">Home</a></li>
                <li><a href="#" onclick="showPage('browse'); closeMobileMenu();">Browse</a></li>
                <li><a href="#" onclick="showPage('list'); closeMobileMenu();" id="mobileListItemLink">List Item</a></li>
                <li><a href="#" onclick="showPage('cart'); closeMobileMenu();" id="mobileCartLink">My Cart</a></li>
                <li><a href="#" onclick="showPage('profile'); closeMobileMenu();" id="mobileProfileLink" style="display: none;">Profile</a></li>
                <li><a href="#" onclick="showPage('my-items'); closeMobileMenu();" id="mobileMyItemsLink" style="display: none;">My Items</a></li>
                <li><a href="#" onclick="logout(); closeMobileMenu();" id="mobileLogoutLink" style="display: none;">Sign Out</a></li>
            </ul>
        </div>
    </header>

    <main>
        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="hero">
                <!-- Hero Carousel -->
                <div class="hero-carousel">
                    <div class="carousel-container">
                        <div class="carousel-slide active">
                            <img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1920&h=1080&fit=crop&crop=center" alt="Fashion Model 1">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://images.unsplash.com/photo-1757691742705-02da7461048a?w=1920&h=1080&fit=crop&crop=center" alt="Fashion Model 2">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://images.unsplash.com/photo-1721884258144-5d788061e4c4?w=1920&h=1080&fit=crop&crop=center" alt="Fashion Model 3">
                        </div>
                        <div class="carousel-slide">
                            <img src="https://images.unsplash.com/photo-1443884590026-2e4d21aee71c?w=1920&h=1080&fit=crop&crop=center" alt="Fashion Model 4">
                        </div>
                    </div>
                    
                </div>
                
                <div class="hero-content">
                    <div class="hero-text">
                        <h1>Fashion Rental</h1>
                        <p>Discover designer pieces from your community. Sustainable, affordable, and effortlessly stylish.</p>
                    </div>
                </div>
            </div>

            <!-- How It Works Section -->
            <div class="container section">
                <h2 class="section-title rentrobe-text">How Rentrobe Works</h2>
                <div class="how-it-works">
                    <div class="step">
                        <div class="step-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20.38 3.46L16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z"/>
                                <path d="M12 9v4"/>
                                <path d="M8 9v4"/>
                                <path d="M16 9v4"/>
                            </svg>
                        </div>
                        <h3>Select a Style</h3>
                        <p>Pick your perfect style from our collection of designer outfits and accessories.</p>
                    </div>
                    
                    <div class="step">
                        <div class="step-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                        </div>
                        <h3>Book your Outfit</h3>
                        <p>Book your look for 3, 5, 7 or 10 days. Outfit will be altered to your size and dry cleaned before delivery.</p>
                    </div>
                    
                    <div class="step">
                        <div class="step-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
                            </svg>
                        </div>
                        <h3>Flaunt It</h3>
                        <p>Flaunt your look with that perfect outfit chosen by you and enjoy the compliments</p>
                    </div>
                    
                    <div class="step">
                        <div class="step-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                <polyline points="3.27,6.96 12,12.01 20.73,6.96"/>
                                <line x1="12" y1="22.08" x2="12" y2="12"/>
                            </svg>
                        </div>
                        <h3>Return It</h3>
                        <p>Pack the outfit and we'll pick it up a day after your occasion or the dates chosen by you.</p>
                    </div>
                </div>
                
            </div>

            <div class="container section">
                <h2 class="section-title">Categories</h2>
                <div class="categories-grid" id="categoriesGrid">
                    <div class="category-card">
                        <div class="category-icon"></div>
                        <h3>Formal Wear</h3>
                        <p>Suits & Evening Dresses</p>
                    </div>
                    <div class="category-card">
                        <div class="category-icon"></div>
                        <h3>Casual Wear</h3>
                        <p>Everyday Fashion</p>
                    </div>
                    <div class="category-card">
                        <div class="category-icon"></div>
                        <h3>Party Outfits</h3>
                        <p>Cocktail & Party Wear</p>
                    </div>
                    <div class="category-card">
                        <div class="category-icon"></div>
                        <h3>Traditional</h3>
                        <p>Ethnic & Cultural</p>
                    </div>
                    <div class="category-card">
                        <div class="category-icon"></div>
                        <h3>Designer</h3>
                        <p>Luxury Brands</p>
                    </div>
                </div>
            </div>

            <div class="container section">
                <h2 class="section-title">Featured Items</h2>
                <div class="items-grid" id="featuredItems">
                    <!-- Items will be loaded here -->
                </div>
                <div class="view-more-container">
                    <button class="btn btn-primary view-more-btn" onclick="showPage('browse')">
                        View More Items
                    </button>
                </div>
            </div>
        </div>

        <!-- Browse Page -->
        <div id="browse" class="page">
            <div class="browse-container">
                <!-- Sidebar -->
                <div class="browse-sidebar">
                    <h3 class="sidebar-title">Filters</h3>
                    
                    <!-- Search Bar -->
                    <div class="sidebar-section">
                        <label class="form-label">Search</label>
                        <input type="text" class="form-input" id="browseSearchInput" placeholder="Search items...">
                    </div>
                    
                    <!-- Filters -->
                    <div class="sidebar-section">
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-input" id="categoryFilter">
                                <option value="">All Categories</option>
                                <option value="formal">Formal Wear</option>
                                <option value="casual">Casual Wear</option>
                                <option value="party">Party Outfits</option>
                                <option value="traditional">Traditional</option>
                                <option value="designer">Designer</option>
                            </select>
                        </div>
                        
                        
                        
                        <div class="form-group">
                            <label class="form-label">Sort By Price</label>
                            <select class="form-input" id="sortFilter" onchange="applySorting()">
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="sidebar-actions">
                        <button class="btn btn-primary" onclick="applyFilters()">Apply Filters</button>
                        <button class="btn" onclick="clearFilters()">Clear</button>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div class="browse-main">
                    <h2 class="section-title">Browse All Items</h2>
                    <div class="items-grid" id="allItems">
                        <div class="loading-spinner">Loading items...</div>
                    </div>
                    
                    <!-- Pagination Controls -->
                <div class="pagination-container" id="paginationContainer" style="display: none;">
                    <div class="pagination">
                        <button class="pagination-btn pagination-prev" id="prevBtn" onclick="changePage(currentPage - 1)">
                            <span></span>
                        </button>
                        <div class="pagination-numbers" id="paginationNumbers">
                            <!-- Page numbers will be generated here -->
                        </div>
                        <button class="pagination-btn pagination-next" id="nextBtn" onclick="changePage(currentPage + 1)">
                            <span></span>
                        </button>
                    </div>
                    <div class="pagination-info" id="paginationInfo">
                        <!-- Pagination info will be displayed here -->
                    </div>
                </div>
                </div>
            </div>
        </div>

        <!-- List Item Page -->
        <div id="list" class="page">
            <div class="container section">
                <h2 class="section-title">List Your Item</h2>
                
                <!-- Login Prompt for List Item -->
                <div id="listLoginPrompt" style="display: none; text-align: center; padding: 60px 20px; max-width: 500px; margin: 0 auto;">
                    <div style="font-size: 48px; margin-bottom: 20px;"></div>
                    <h3 style="color: var(--gray-600); margin-bottom: 10px;">Login to List Items</h3>
                    <p style="color: var(--gray-500); margin-bottom: 30px;">You need to be logged in to list your items for rent</p>
                    <div style="display: flex; gap: 12px; justify-content: center;">
                        <a href="#" class="btn" onclick="showModal('loginModal')">Sign In</a>
                        <a href="#" class="btn btn-primary" onclick="showModal('signupModal')">Join Now</a>
                    </div>
                </div>
                
                <!-- List Item Form (shown when logged in) -->
                <div id="listFormContainer" style="max-width: 500px; margin: 0 auto;">
                    <div class="alert alert-success" id="listSuccess">Item listed successfully!</div>
                    <div class="alert alert-error" id="listError">Please fill all required fields.</div>

                    <form id="listForm">
                        <div class="form-group">
                            <label class="form-label">Title</label>
                            <input type="text" class="form-input" id="itemTitle" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-input form-textarea" id="itemDescription" required></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-input" id="itemCategory" required>
                                <option value="">Select Category</option>
                                <option value="formal">Formal Wear</option>
                                <option value="casual">Casual Wear</option>
                                <option value="party">Party Outfits</option>
                                <option value="traditional">Traditional</option>
                                <option value="designer">Designer</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Size</label>
                            <select class="form-input" id="itemSize" required>
                                <option value="">Select Size</option>
                                <option value="XS">XS</option>
                                <option value="S">S</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                                <option value="XXL">XXL</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Price per Day ()</label>
                            <input type="number" class="form-input" id="itemPrice" min="1" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Security Deposit ()</label>
                            <input type="number" class="form-input" id="itemDeposit" min="0" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Images</label>
                            <div class="file-upload" onclick="document.getElementById('itemImages').click()">
                                <input type="file" id="itemImages" multiple accept="image/*">
                                <p>Click to upload images</p>
                                <p style="font-size: 12px; color: var(--gray-500);">Max 5 images</p>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            <span class="spinner" id="listSpinner"></span>
                            List Item
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Other pages placeholders -->
        <div id="my-items" class="page">
            <div class="container section">
                <h2 class="section-title">My Items</h2>
                <div id="myItemsContainer"></div>
            </div>
        </div>

        <div id="rentals" class="page">
            <div class="container section">
                <h2 class="section-title">Requests</h2>
                <div id="rentalsContainer"></div>
            </div>
        </div>

        <div id="profile" class="page">
            <div class="container section">
                <h2 class="section-title">Profile</h2>
                <div style="max-width: 400px; margin: 0 auto;">
                    <div class="alert alert-success" id="profileSuccess">Profile updated!</div>
                    <form id="profileForm">
                        <div class="form-group">
                            <label class="form-label">Name</label>
                            <input type="text" class="form-input" id="profileName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" id="profileEmail" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone</label>
                            <input type="tel" class="form-input" id="profilePhone">
                        </div>
                        <div class="form-group">
                            <label class="form-label">City</label>
                            <input type="text" class="form-input" id="profileCity">
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Update Profile</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Cart Page -->
        <div id="cart" class="page">
            <div class="container section">
                <h2 class="section-title">My Cart</h2>
                
                <!-- Login Prompt for My Cart -->
                <div id="cartLoginPrompt" style="display: none; text-align: center; padding: 60px 20px; max-width: 500px; margin: 0 auto;">
                    <div style="font-size: 48px; margin-bottom: 20px;"></div>
                    <h3 style="color: var(--gray-600); margin-bottom: 10px;">Login to View Your Cart</h3>
                    <p style="color: var(--gray-500); margin-bottom: 30px;">You need to be logged in to view and manage your cart</p>
                    <div style="display: flex; gap: 12px; justify-content: center;">
                        <a href="#" class="btn" onclick="showModal('loginModal')">Sign In</a>
                        <a href="#" class="btn btn-primary" onclick="showModal('signupModal')">Join Now</a>
                    </div>
                </div>
                
                <!-- Cart Content (shown when logged in) -->
                <div id="cartContainer">
                    <div class="empty-cart" style="text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;"></div>
                        <h3 style="color: var(--gray-600); margin-bottom: 10px;">Your cart is empty</h3>
                        <p style="color: var(--gray-500); margin-bottom: 30px;">Start browsing to add items to your cart</p>
                        <a href="#" class="btn btn-primary" onclick="showPage('browse')">Browse Items</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resources Page -->
        <div id="resources" class="page">
            <div class="container section">
                <h2 class="section-title">Resources</h2>
                <div class="resources-content">
                    <div class="resource-section">
                        <h3>Getting Started</h3>
                        <div class="resource-grid">
                            <div class="resource-card">
                                <h4>How to Rent</h4>
                                <p>Learn how to browse, select, and rent items from our platform.</p>
                                <a href="#" class="btn btn-outline">Read Guide</a>
                            </div>
                            <div class="resource-card">
                                <h4>How to List</h4>
                                <p>Step-by-step guide to listing your items for rent.</p>
                                <a href="#" class="btn btn-outline">Read Guide</a>
                            </div>
                            <div class="resource-card">
                                <h4>Safety Guidelines</h4>
                                <p>Important safety tips for renting and listing items.</p>
                                <a href="#" class="btn btn-outline">Read Guide</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="resource-section">
                        <h3>Help Center</h3>
                        <div class="help-links">
                            <a href="#" onclick="showPage('faq'); return false;" class="help-link">
                                <span class="help-icon"></span>
                                <div>
                                    <h4>Frequently Asked Questions</h4>
                                    <p>Find answers to common questions</p>
                                </div>
                            </a>
                            <a href="#" onclick="showPage('contact'); return false;" class="help-link">
                                <span class="help-icon"></span>
                                <div>
                                    <h4>Contact Support</h4>
                                    <p>Get help from our support team</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Us Page -->
        <div id="about" class="page">
            <div class="container section">
                <h2 class="section-title">About Us</h2>
                <div class="about-content">
                    <div class="about-hero">
                        <h3>Welcome to Rentrobe</h3>
                        <p class="about-intro">
                            We're revolutionizing the way people access fashion by creating a sustainable, 
                            affordable, and convenient clothing rental platform. Our mission is to make 
                            high-quality fashion accessible to everyone while promoting sustainable consumption.
                        </p>
                    </div>
                    
                    <div class="about-sections">
                        <div class="about-section">
                            <h4>Our Story</h4>
                            <p>
                                Founded in 2025, Rentrobe started with a simple idea: what if you could 
                                access an unlimited wardrobe without the cost and environmental impact of 
                                buying new clothes? We've built a community where fashion lovers can 
                                share, rent, and discover amazing pieces.
                            </p>
                        </div>
                        
                        <div class="about-section">
                            <h4>Our Mission</h4>
                            <p>
                                To democratize fashion by making designer and high-quality clothing 
                                accessible through rental, reducing fashion waste, and building a 
                                sustainable fashion ecosystem.
                            </p>
                        </div>
                        
                        <div class="about-section">
                            <h4>Our Values</h4>
                            <ul class="values-list">
                                <li><strong>Sustainability:</strong> Promoting circular fashion and reducing waste</li>
                                <li><strong>Accessibility:</strong> Making fashion affordable for everyone</li>
                                <li><strong>Community:</strong> Building connections between fashion enthusiasts</li>
                                <li><strong>Quality:</strong> Ensuring every item meets our high standards</li>
                                <li><strong>Trust:</strong> Creating a safe and reliable platform</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAQ Page -->
        <div id="faq" class="page">
            <div class="container section">
                <h2 class="section-title">Frequently Asked Questions</h2>
                <div class="faq-content">
                    <div class="faq-section">
                        <h3>Renting Items</h3>
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>How do I rent an item?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>Simply browse our catalog, select the item you want, choose your rental period, and proceed to checkout. You'll receive confirmation and pickup details via email.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>What is the rental period?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>Our standard rental period is 4 days, but you can extend it for an additional fee. Some items may have different rental periods.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>What if I damage an item?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>Minor wear and tear is expected. For significant damage, you'll be charged a repair or replacement fee based on the item's value.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-section">
                        <h3>Listing Items</h3>
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>How do I list my items?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>Create an account, go to "List Item", fill out the item details, upload photos, and set your rental price. We'll review and approve your listing.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>How much can I earn?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>You keep 80% of the rental fee, while we take 20% to cover platform costs, insurance, and maintenance.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-section">
                        <h3>Account & Payment</h3>
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>What payment methods do you accept?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>We accept all major credit cards, debit cards, UPI, and digital wallets like PayPal, Google Pay, and Apple Pay.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <h4>Is my payment information secure?</h4>
                                <span class="faq-toggle">+</span>
                            </div>
                            <div class="faq-answer">
                                <p>Yes, we use industry-standard encryption and never store your payment details. All transactions are processed securely.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Us Page -->
        <div id="contact" class="page">
            <div class="container section">
                <h2 class="section-title">Contact Us</h2>
                <div class="contact-content">
                    <div class="contact-info">
                        <div class="contact-card">
                            <div class="contact-icon"></div>
                            <h3>Email Us</h3>
                            <p>support@rentrobe.com</p>
                            <p>We typically respond within 24 hours</p>
                        </div>
                        
                        <div class="contact-card">
                            <div class="contact-icon"></div>
                            <h3>Call Us</h3>
                            <p>+91 98765 43210</p>
                            <p>Mon-Fri: 9AM-6PM IST</p>
                        </div>
                        
                        <div class="contact-card">
                            <div class="contact-icon"></div>
                            <h3>Visit Us</h3>
                            <p>C Block, Rungta Educational Campus</p>
                            <p>Kurud Rd, Kohka, Bhilai - 490024</p>
                            <p>Chhattisgarh, India</p>
                        </div>
                    </div>
                    
                    <div class="contact-form-section">
                        <h3>Send us a Message</h3>
                        <form class="contact-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">First Name</label>
                                    <input type="text" class="form-input" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Last Name</label>
                                    <input type="text" class="form-input" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-input" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Subject</label>
                                <select class="form-input" required>
                                    <option value="">Select a subject</option>
                                    <option value="general">General Inquiry</option>
                                    <option value="support">Technical Support</option>
                                    <option value="billing">Billing Question</option>
                                    <option value="partnership">Partnership</option>
                                    <option value="feedback">Feedback</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Message</label>
                                <textarea class="form-input" rows="5" placeholder="Tell us how we can help you..." required></textarea>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Send Message</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Terms of Service Page -->
        <div id="terms" class="page">
            <div class="container section">
                <h2 class="section-title">Terms of Service</h2>
                <div class="legal-content">
                    <h3>1. Acceptance of Terms</h3>
                    <p>By accessing and using RentRobe, you accept and agree to be bound by the terms and provision of this agreement.</p>
                    
                    <h3>2. Use License</h3>
                    <p>Permission is granted to temporarily download one copy of RentRobe per device for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:</p>
                    <ul>
                        <li>modify or copy the materials</li>
                        <li>use the materials for any commercial purpose or for any public display</li>
                        <li>attempt to reverse engineer any software contained on RentRobe</li>
                        <li>remove any copyright or other proprietary notations from the materials</li>
                    </ul>
                    
                    <h3>3. Rental Terms</h3>
                    <p>All rentals are subject to availability and approval. Renters must:</p>
                    <ul>
                        <li>Be at least 18 years old</li>
                        <li>Provide valid identification</li>
                        <li>Return items in the same condition as received</li>
                        <li>Pay all applicable fees and deposits</li>
                    </ul>
                    
                    <h3>4. Limitation of Liability</h3>
                    <p>In no event shall RentRobe or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use RentRobe, even if RentRobe or a RentRobe authorized representative has been notified orally or in writing of the possibility of such damage.</p>
                    
                    <h3>5. Revisions</h3>
                    <p>RentRobe may revise these terms of service at any time without notice. By using this web site you are agreeing to be bound by the then current version of these terms of service.</p>
                    
                    <p><strong>Last updated:</strong> October 2025</p>
                </div>
            </div>
        </div>

        <!-- Privacy Policy Page -->
        <div id="privacy" class="page">
            <div class="container section">
                <h2 class="section-title">Privacy Policy</h2>
                <div class="legal-content">
                    <h3>1. Information We Collect</h3>
                    <p>We collect information you provide directly to us, such as when you create an account, make a rental, or contact us for support. This may include:</p>
                    <ul>
                        <li>Name, email address, and phone number</li>
                        <li>Payment information (processed securely through third-party providers)</li>
                        <li>Profile information and preferences</li>
                        <li>Communication history with our support team</li>
                    </ul>
                    
                    <h3>2. How We Use Your Information</h3>
                    <p>We use the information we collect to:</p>
                    <ul>
                        <li>Provide, maintain, and improve our services</li>
                        <li>Process transactions and send related information</li>
                        <li>Send technical notices and support messages</li>
                        <li>Respond to your comments and questions</li>
                        <li>Monitor and analyze trends and usage</li>
                    </ul>
                    
                    <h3>3. Information Sharing</h3>
                    <p>We do not sell, trade, or otherwise transfer your personal information to third parties without your consent, except:</p>
                    <ul>
                        <li>To trusted service providers who assist us in operating our website</li>
                        <li>When required by law or to protect our rights</li>
                        <li>In connection with a merger, sale, or acquisition</li>
                    </ul>
                    
                    <h3>4. Data Security</h3>
                    <p>We implement appropriate security measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction.</p>
                    
                    <h3>5. Your Rights</h3>
                    <p>You have the right to:</p>
                    <ul>
                        <li>Access and update your personal information</li>
                        <li>Request deletion of your account and data</li>
                        <li>Opt out of marketing communications</li>
                        <li>Request a copy of your data</li>
                    </ul>
                    
                    <p><strong>Last updated:</strong> October 2025</p>
                </div>
            </div>
        </div>

        <!-- Cookie Policy Page -->
        <div id="cookies" class="page">
            <div class="container section">
                <h2 class="section-title">Cookie Policy</h2>
                <div class="legal-content">
                    <h3>1. What Are Cookies</h3>
                    <p>Cookies are small text files that are placed on your computer or mobile device when you visit our website. They help us provide you with a better experience by remembering your preferences and enabling certain functionality.</p>
                    
                    <h3>2. Types of Cookies We Use</h3>
                    
                    <h4>Essential Cookies</h4>
                    <p>These cookies are necessary for the website to function properly. They enable basic functions like page navigation and access to secure areas of the website.</p>
                    
                    <h4>Performance Cookies</h4>
                    <p>These cookies collect information about how visitors use our website, such as which pages are visited most often. This helps us improve how our website works.</p>
                    
                    <h4>Functionality Cookies</h4>
                    <p>These cookies allow the website to remember choices you make and provide enhanced, more personal features.</p>
                    
                    <h4>Marketing Cookies</h4>
                    <p>These cookies are used to track visitors across websites to display relevant and engaging advertisements.</p>
                    
                    <h3>3. How We Use Cookies</h3>
                    <p>We use cookies to:</p>
                    <ul>
                        <li>Remember your login status and preferences</li>
                        <li>Analyze website traffic and usage patterns</li>
                        <li>Improve website performance and user experience</li>
                        <li>Provide personalized content and recommendations</li>
                        <li>Enable social media features</li>
                    </ul>
                    
                    <h3>4. Managing Cookies</h3>
                    <p>You can control and manage cookies in various ways:</p>
                    <ul>
                        <li>Through your browser settings</li>
                        <li>Using our cookie preference center</li>
                        <li>By opting out of specific cookie categories</li>
                    </ul>
                    
                    <h3>5. Third-Party Cookies</h3>
                    <p>Some cookies on our site are set by third-party services that appear on our pages. We do not control these cookies and recommend checking the third-party websites for more information about their cookies.</p>
                    
                    <p><strong>Last updated:</strong> October 2025</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="hideModal('loginModal')">&times;</span>
            <h2 class="modal-title">Sign In</h2>
            <div class="alert alert-error" id="loginError">Invalid credentials.</div>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" class="form-input" id="loginPassword" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="spinner" id="loginSpinner"></span>Sign In
                </button>
            </form>
            <div style="text-align: center; margin-top: 16px;">
                <p style="color: var(--text-secondary); font-size: 14px;">
                    Don't have an account? 
                    <a href="#" onclick="hideModal('loginModal'); showModal('signupModal');" 
                       style="color: var(--theme-accent); text-decoration: none; font-weight: 500;">
                        Create Account
                    </a>
                </p>
            </div>
        </div>
    </div>

    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="hideModal('signupModal')">&times;</span>
            <h2 class="modal-title">Join Rentrobe</h2>
            <div class="alert alert-error" id="signupError">Please fill all fields correctly.</div>
            <form id="signupForm">
                <div class="form-group">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-input" id="signupName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="signupEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" class="form-input" id="signupPassword" required minlength="6">
                        <button type="button" class="password-toggle" onclick="togglePassword('signupPassword')">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" id="signupPhone" required>
                </div>
                <div class="form-group">
                    <label class="form-label">City</label>
                    <input type="text" class="form-input" id="signupCity" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="spinner" id="signupSpinner"></span>Create Account
                </button>
            </form>
            <div style="text-align: center; margin-top: 16px;">
                <p style="color: var(--text-secondary); font-size: 14px;">
                    Already have an account? 
                    <a href="#" onclick="hideModal('signupModal'); showModal('loginModal');" 
                       style="color: var(--theme-accent); text-decoration: none; font-weight: 500;">
                        Sign In
                    </a>
                </p>
            </div>
        </div>
    </div>

    <div id="itemModal" class="modal">
        <div class="modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
            <span class="modal-close" onclick="hideModal('itemModal')">&times;</span>
            <div id="itemModalContent"></div>
        </div>
    </div>

    <!-- Rental Modal -->
    <div id="rentalModal" class="modal">
        <div class="modal-content" style="max-width: 520px;">
            <span class="modal-close" onclick="hideModal('rentalModal')">&times;</span>
            <h2 class="modal-title">Request Rental</h2>
            <div class="alert alert-success" id="rentalSuccess">Rental request sent!</div>
            <div class="alert alert-error" id="rentalError">Please select valid dates.</div>
            <form id="rentalForm">
                <input type="hidden" id="rentalItemId">
                <div class="form-group">
                    <label class="form-label">Start Date</label>
                    <input type="date" class="form-input" id="rentalStart" required>
                </div>
                <div class="form-group">
                    <label class="form-label">End Date</label>
                    <input type="date" class="form-input" id="rentalEnd" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Message (optional)</label>
                    <textarea class="form-input form-textarea" id="rentalMessage" placeholder="Anything the owner should know?"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="spinner" id="rentalSpinner"></span>Send Request
                </button>
            </form>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <!-- Company Information Column -->
            <div class="footer-brand">
                <div class="footer-brand-logo">
                    <img src="static/LOGO_W.png" alt="Rentrobe">
                </div>
                <div class="footer-address">
                    <div>C Block, Rungta Educational Campus</div>
                    <div>Kurud Rd, Kohka</div>
                    <div>Bhilai - 490024</div>
                    <div>Chhattisgarh</div>
                </div>
                <div class="footer-contact">
                    <div class="footer-contact-item">
                        <div class="footer-contact-label">Phone number</div>
                        <div class="footer-contact-value">+91 98765 43210</div>
                    </div>
                    <div class="footer-contact-item">
                        <div class="footer-contact-label">Email</div>
                        <div class="footer-contact-value">support@rentrobe.com</div>
                    </div>
                </div>
            </div>

            <!-- Quick Links Column -->
            <div class="footer-column">
                <h4>Quick links</h4>
                <ul class="footer-links">
                    <li><a href="#" onclick="showPage('resources'); return false;">Resources</a></li>
                    <li><a href="#" onclick="showPage('about'); return false;">About us</a></li>
                    <li><a href="#" onclick="showPage('faq'); return false;">FAQ</a></li>
                    <li><a href="#" onclick="showPage('contact'); return false;">Contact us</a></li>
                </ul>
            </div>

            <!-- Social Links Column -->
            <div class="footer-column">
                <h4>Social</h4>
                <ul class="footer-links">
                    <li><a href="https://www.facebook.com/">Facebook</a></li>
                    <li><a href="https://www.instagram.com/">Instagram</a></li>
                    <li><a href="https://in.linkedin.com/">LinkedIn</a></li>
                    <li><a href="https://www.x.com">Twitter</a></li>
                    <li><a href="https://www.youtube.com">Youtube</a></li>
                </ul>
            </div>

            <!-- Legal Links Column -->
            <div class="footer-column">
                <h4>Legal</h4>
                <ul class="footer-links">
                    <li><a href="#" onclick="showPage('terms'); return false;">Terms of service</a></li>
                    <li><a href="#" onclick="showPage('privacy'); return false;">Privacy policy</a></li>
                    <li><a href="#" onclick="showPage('cookies'); return false;">Cookie policy</a></li>
                </ul>
            </div>
        </div>
        
        <!-- Bottom Text -->
        <div class="footer-bottom">
            <div class="footer-content">
                <div class="footer-bottom-text">
                    <p>--------</p>
                    <p>&copy; 2025 Rentrobe. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentUser = null;
        let items = [];
        let filteredItems = [];
        let currentSlideIndex = 0;
        let slideInterval;
        
        // Pagination variables
        let currentPage = 1;
        let itemsPerPage = 12;
        let totalPages = 1;
        
        // Sorting variables
        let currentSort = 'price-low';
        
        // Track protected page access
        let attemptedProtectedPage = null;


        // Enhanced Sample Data - Comprehensive Fashion Rental Items
        const sampleItems = [
            // FORMAL WEAR
            {
                id: 1,
                title: 'Black Evening Gown',
                description: 'Elegant black evening gown perfect for formal events and galas. Features intricate beadwork and a flowing silhouette.',
                category: 'formal',
                size: 'M',
                price: 800,
                deposit: 2000,
                owner: { name: 'Priya Sharma', city: 'Mumbai', initial: 'P', rating: 4.8 },
                status: 'available',
                rating: 4.9,
                reviews: 12,
                views: 145,
                images: [
                    'https://images.unsplash.com/photo-1657023855158-3878cac29205?w=300&h=400&fit=crop&crop=center&q=80',
                    'https://images.unsplash.com/photo-1657023799657-df1cee617db5?w=300&h=400&fit=crop&crop=center&q=80'
                ]
            },
            {
                id: 2,
                title: 'Navy Blue Business Suit',
                description: 'Professional navy suit perfect for business meetings and corporate events. Tailored fit with premium fabric.',
                category: 'formal',
                size: 'L',
                price: 700,
                deposit: 1800,
                owner: { name: 'Rajesh Kumar', city: 'Delhi', initial: 'R', rating: 4.9 },
                status: 'available',
                rating: 4.8,
                reviews: 8,
                views: 89,
                images: [
                    'https://plus.unsplash.com/premium_photo-1679440414275-f9950b562c7f?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://plus.unsplash.com/premium_photo-1679440413349-556c1366112f?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 3,
                title: 'White Wedding Dress',
                description: 'Stunning white wedding dress with lace details and cathedral train. Perfect for your special day.',
                category: 'formal',
                size: 'S',
                price: 1500,
                deposit: 4000,
                owner: { name: 'Kavya Nair', city: 'Kochi', initial: 'K', rating: 4.9 },
                status: 'available',
                rating: 5.0,
                reviews: 15,
                views: 234,
                images: [
                    'https://images.unsplash.com/photo-1678831165438-e2bb89db82d9?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://images.unsplash.com/photo-1678830795557-d7886693c9ee?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 4,
                title: 'Black Tuxedo',
                description: 'Classic black tuxedo for formal occasions and black-tie events. Includes bow tie and cummerbund.',
                category: 'formal',
                size: 'L',
                price: 1000,
                deposit: 2500,
                owner: { name: 'Rohit Agarwal', city: 'Delhi', initial: 'R', rating: 4.9 },
                status: 'available',
                rating: 4.7,
                reviews: 6,
                views: 67,
                images: [
                    'https://images.unsplash.com/photo-1598808503746-f34c53b9323e?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://images.unsplash.com/photo-1585412459212-8def26f7e84c?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 5,
                title: 'Grey Business Suit',
                description: 'Professional grey suit for corporate meetings and formal presentations. Modern slim fit.',
                category: 'formal',
                size: 'M',
                price: 750,
                deposit: 1900,
                owner: { name: 'Amit Sharma', city: 'Gurgaon', initial: 'A', rating: 4.7 },
                status: 'available',
                rating: 4.6,
                reviews: 9,
                views: 78,
                images: [
                    'https://plus.unsplash.com/premium_photo-1682430740985-acbce7ec295e?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://plus.unsplash.com/premium_photo-1682430700877-d85b273bc253?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 6,
                title: 'Maroon Blazer',
                description: 'Elegant maroon blazer for formal occasions and business casual events.',
                category: 'formal',
                size: 'S',
                price: 650,
                deposit: 1600,
                owner: { name: 'Priyanka Das', city: 'Kolkata', initial: 'P', rating: 4.7 },
                status: 'available',
                rating: 4.5,
                reviews: 7,
                views: 56,
                images: [
                    'https://plus.unsplash.com/premium_photo-1730828573906-f44ac401de96?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://plus.unsplash.com/premium_photo-1730828573973-cf4e4ecc2950?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },

            // PARTY OUTFITS
            {
                id: 7,
                title: 'Premium Cocktail Dress',
                description: 'Beautiful red cocktail dress from premium brand. Perfect for cocktail parties and evening events.',
                category: 'party',
                size: 'S',
                price: 600,
                deposit: 1500,
                owner: { name: 'Anjali Reddy', city: 'Bangalore', initial: 'A', rating: 4.6 },
                status: 'available',
                rating: 4.8,
                reviews: 11,
                views: 123,
                images: [
                    'https://images.unsplash.com/photo-1721182421063-19a6c711b719?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://images.unsplash.com/photo-1721182420935-29bfb69dd26c?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 8,
                title: 'Pink Party Dress',
                description: 'Vibrant pink dress perfect for parties and celebrations. Features sequin details and flowing fabric.',
                category: 'party',
                size: 'M',
                price: 450,
                deposit: 1000,
                owner: { name: 'Riya Jain', city: 'Jaipur', initial: 'R', rating: 4.6 },
                status: 'available',
                rating: 4.7,
                reviews: 8,
                views: 92,
                images: [
                    'https://images.unsplash.com/photo-1708121691161-b8b11bebc761?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://images.unsplash.com/photo-1708121691158-270470206446?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 9,
                title: 'Green Cocktail Dress',
                description: 'Elegant green cocktail dress for special events and dinner parties.',
                category: 'party',
                size: 'S',
                price: 550,
                deposit: 1300,
                owner: { name: 'Pooja Kapoor', city: 'Chandigarh', initial: 'P', rating: 4.6 },
                status: 'available',
                rating: 4.6,
                reviews: 5,
                views: 73,
                images: [
                    'https://images.unsplash.com/photo-1566479179817-c0c8e5c7b7b8?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 10,
                title: 'Purple Party Gown',
                description: 'Stunning purple gown perfect for evening parties and special celebrations.',
                category: 'party',
                size: 'L',
                price: 700,
                deposit: 1700,
                owner: { name: 'Shreya Patel', city: 'Surat', initial: 'S', rating: 4.5 },
                status: 'available',
                rating: 4.9,
                reviews: 13,
                views: 156,
                images: [
                    'https://images.unsplash.com/photo-1566479179817-c0c8e5c7b7b8?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 11,
                title: 'Silver Sequin Dress',
                description: 'Glamorous silver sequin dress for parties and New Year celebrations.',
                category: 'party',
                size: 'M',
                price: 800,
                deposit: 2000,
                owner: { name: 'Natasha Malhotra', city: 'Delhi', initial: 'N', rating: 4.6 },
                status: 'available',
                rating: 4.8,
                reviews: 10,
                views: 134,
                images: [
                    'https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 12,
                title: 'Blue Velvet Dress',
                description: 'Luxurious blue velvet dress perfect for winter parties and elegant events.',
                category: 'party',
                size: 'M',
                price: 650,
                deposit: 1600,
                owner: { name: 'Ishita Agarwal', city: 'Delhi', initial: 'I', rating: 4.9 },
                status: 'available',
                rating: 4.7,
                reviews: 9,
                views: 87,
                images: [
                    'https://images.unsplash.com/photo-1566479179817-c0c8e5c7b7b8?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },

            // TRADITIONAL WEAR
            {
                id: 13,
                title: 'Traditional Lehenga',
                description: 'Beautiful traditional lehenga with intricate embroidery work. Perfect for weddings and festivals.',
                category: 'traditional',
                size: 'M',
                price: 1200,
                deposit: 3000,
                owner: { name: 'Meera Patel', city: 'Ahmedabad', initial: 'M', rating: 4.7 },
                status: 'available',
                rating: 4.9,
                reviews: 14,
                views: 189,
                images: [
                    'https://plus.unsplash.com/premium_photo-1682096032284-0b2ab20b65dd?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://plus.unsplash.com/premium_photo-1682096067532-3e89ab323ebf?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 14,
                title: 'Golden Saree',
                description: 'Traditional golden saree with intricate work. Perfect for weddings and special occasions.',
                category: 'traditional',
                size: 'One Size',
                price: 900,
                deposit: 2200,
                owner: { name: 'Lakshmi Iyer', city: 'Chennai', initial: 'L', rating: 4.8 },
                status: 'available',
                rating: 4.8,
                reviews: 11,
                views: 145,
                images: [
                    'https://images.unsplash.com/photo-1583391733956-6c78276477e2?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 15,
                title: 'Red Traditional Kurta',
                description: 'Beautiful red kurta with traditional embroidery. Perfect for festivals and cultural events.',
                category: 'traditional',
                size: 'L',
                price: 400,
                deposit: 900,
                owner: { name: 'Sanjay Gupta', city: 'Varanasi', initial: 'S', rating: 4.4 },
                status: 'available',
                rating: 4.5,
                reviews: 6,
                views: 67,
                images: [
                    'https://images.unsplash.com/photo-1622470953794-aa9c70b0fb9d?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 16,
                title: 'Silk Dupatta',
                description: 'Beautiful silk dupatta with golden border. Perfect complement to traditional outfits.',
                category: 'traditional',
                size: 'One Size',
                price: 300,
                deposit: 700,
                owner: { name: 'Anita Joshi', city: 'Jodhpur', initial: 'A', rating: 4.8 },
                status: 'available',
                rating: 4.6,
                reviews: 8,
                views: 54,
                images: [
                    'https://images.unsplash.com/photo-1583391733956-6c78276477e2?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 17,
                title: 'Banarasi Silk Saree',
                description: 'Exquisite Banarasi silk saree with gold work. A masterpiece of traditional craftsmanship.',
                category: 'traditional',
                size: 'One Size',
                price: 1100,
                deposit: 2800,
                owner: { name: 'Geeta Sharma', city: 'Varanasi', initial: 'G', rating: 4.8 },
                status: 'available',
                rating: 5.0,
                reviews: 16,
                views: 201,
                images: [
                    'https://images.unsplash.com/photo-1583391733956-6c78276477e2?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 18,
                title: 'Punjabi Suit Set',
                description: 'Complete Punjabi suit set with dupatta. Perfect for cultural celebrations and festivals.',
                category: 'traditional',
                size: 'M',
                price: 500,
                deposit: 1200,
                owner: { name: 'Simran Kaur', city: 'Chandigarh', initial: 'S', rating: 4.7 },
                status: 'available',
                rating: 4.7,
                reviews: 9,
                views: 98,
                images: [
                    'https://images.unsplash.com/photo-1583391733956-6c78276477e2?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },

            // CASUAL WEAR
            {
                id: 19,
                title: 'Casual Denim Jacket',
                description: 'Trendy denim jacket perfect for casual outings and weekend wear.',
                category: 'casual',
                size: 'L',
                price: 300,
                deposit: 800,
                owner: { name: 'Rahul Singh', city: 'Pune', initial: 'R', rating: 4.5 },
                status: 'available',
                rating: 4.4,
                reviews: 7,
                views: 76,
                images: [
                    'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=300&h=400&q=80&fit=crop&crop=center',
                    'https://images.unsplash.com/photo-1520423465871-0866049020b7?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 20,
                title: 'Blue Casual Shirt',
                description: 'Comfortable blue casual shirt for everyday wear and casual meetings.',
                category: 'casual',
                size: 'M',
                price: 200,
                deposit: 500,
                owner: { name: 'Arjun Mehta', city: 'Hyderabad', initial: 'A', rating: 4.7 },
                status: 'available',
                rating: 4.3,
                reviews: 5,
                views: 45,
                images: [
                    'https://images.unsplash.com/photo-1602810318383-e386cc2a3ccf?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 21,
                title: 'White Sneakers',
                description: 'Trendy white sneakers perfect for casual outfits and daily wear.',
                category: 'casual',
                size: '8',
                price: 250,
                deposit: 600,
                owner: { name: 'Neha Verma', city: 'Lucknow', initial: 'N', rating: 4.7 },
                status: 'available',
                rating: 4.5,
                reviews: 8,
                views: 67,
                images: [
                    'https://images.unsplash.com/photo-1549298916-b41d501d3772?w=300&h=300&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 22,
                title: 'Denim Jeans',
                description: 'Classic blue denim jeans for casual wear. Comfortable fit and durable fabric.',
                category: 'casual',
                size: '32',
                price: 180,
                deposit: 450,
                owner: { name: 'Karan Singh', city: 'Amritsar', initial: 'K', rating: 4.6 },
                status: 'available',
                rating: 4.2,
                reviews: 6,
                views: 43,
                images: [
                    'https://images.unsplash.com/photo-1542272604-787c3835535d?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 23,
                title: 'Cotton T-Shirt',
                description: 'Comfortable cotton t-shirt for daily wear. Soft fabric and perfect fit.',
                category: 'casual',
                size: 'L',
                price: 150,
                deposit: 350,
                owner: { name: 'Suresh Kumar', city: 'Patna', initial: 'S', rating: 4.5 },
                status: 'available',
                rating: 4.1,
                reviews: 4,
                views: 32,
                images: [
                    'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 24,
                title: 'Casual Summer Dress',
                description: 'Light and breezy summer dress perfect for casual outings and beach trips.',
                category: 'casual',
                size: 'S',
                price: 280,
                deposit: 650,
                owner: { name: 'Tanvi Joshi', city: 'Bangalore', initial: 'T', rating: 4.8 },
                status: 'available',
                rating: 4.6,
                reviews: 9,
                views: 89,
                images: [
                    'https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },


            // DESIGNER ITEMS
            {
                id: 31,
                title: 'Gucci Evening Dress',
                description: 'Authentic Gucci evening dress in pristine condition. A true luxury piece.',
                category: 'designer',
                size: 'M',
                price: 2000,
                deposit: 5000,
                owner: { name: 'Aditya Kapoor', city: 'Mumbai', initial: 'A', rating: 4.7 },
                status: 'available',
                rating: 5.0,
                reviews: 18,
                views: 289,
                images: [
                    'https://images.unsplash.com/photo-1657023855158-3878cac29205?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 32,
                title: 'Versace Blazer',
                description: 'Designer Versace blazer for the fashion-forward individual. Premium quality.',
                category: 'designer',
                size: 'L',
                price: 1800,
                deposit: 4500,
                owner: { name: 'Rohan Desai', city: 'Pune', initial: 'R', rating: 4.6 },
                status: 'available',
                rating: 4.9,
                reviews: 15,
                views: 234,
                images: [
                    'https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 33,
                title: 'Prada Handbag',
                description: 'Authentic Prada handbag in excellent condition. A timeless luxury accessory.',
                category: 'designer',
                size: 'One Size',
                price: 1500,
                deposit: 3800,
                owner: { name: 'Nikhil Rao', city: 'Hyderabad', initial: 'N', rating: 4.5 },
                status: 'available',
                rating: 4.8,
                reviews: 12,
                views: 178,
                images: [
                    'https://images.unsplash.com/photo-1652427019217-3ded1a356f10?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 34,
                title: 'Armani Suit',
                description: 'Giorgio Armani suit in navy blue. Perfect for high-profile business meetings.',
                category: 'designer',
                size: 'M',
                price: 2200,
                deposit: 5500,
                owner: { name: 'Varun Malhotra', city: 'Delhi', initial: 'V', rating: 4.6 },
                status: 'available',
                rating: 4.9,
                reviews: 16,
                views: 267,
                images: [
                    'https://plus.unsplash.com/premium_photo-1679440414275-f9950b562c7f?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            },
            {
                id: 35,
                title: 'Chanel Dress',
                description: 'Classic Chanel dress in black. An iconic piece from the luxury fashion house.',
                category: 'designer',
                size: 'S',
                price: 2500,
                deposit: 6000,
                owner: { name: 'Akash Patel', city: 'Ahmedabad', initial: 'A', rating: 4.9 },
                status: 'available',
                rating: 5.0,
                reviews: 20,
                views: 345,
                images: [
                    'https://images.unsplash.com/photo-1657023855158-3878cac29205?w=300&h=400&q=80&fit=crop&crop=center'
                ]
            }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Clear any corrupted localStorage data
            try {
                const testData = localStorage.getItem('rentrobe_user');
                if (testData === 'undefined' || testData === 'null') {
                    localStorage.removeItem('rentrobe_user');
                }
            } catch (e) {
                localStorage.removeItem('rentrobe_user');
            }
            
            // Clear localStorage completely for fresh start (remove this after testing)
            // localStorage.clear();
            
            const hasValidUserFromStorage = loadUserFromStorage();
            initializeItems();
            setupEventListeners();
            
            // Only fetch from server if we don't have a valid user from localStorage
            // For Netlify deployment, we rely primarily on localStorage
            if (!hasValidUserFromStorage) {
                console.log('No valid user from storage, checking server...');
                fetchCurrentUser().finally(() => {
                    updateAuthUI();
                });
            } else {
                console.log('Using user from localStorage, skipping server fetch');
                updateAuthUI();
            }
            
            initializeCarousel();
            initializeHeaderScroll();
            // Rental form listeners
            const rentalForm = document.getElementById('rentalForm');
            if (rentalForm) {
                rentalForm.addEventListener('submit', handleRentalSubmit);
                const rs = document.getElementById('rentalStart');
                const re = document.getElementById('rentalEnd');
                if (rs) rs.addEventListener('change', validateRentalDates);
                if (re) re.addEventListener('change', validateRentalDates);
            }
        });

        async function fetchCurrentUser() {
            try {
                console.log('Checking user authentication...');
                
                // For Netlify deployment, we rely primarily on localStorage
                // since serverless functions don't maintain sessions
                const savedUser = localStorage.getItem('rentrobe_user');
                if (savedUser) {
                    try {
                        currentUser = JSON.parse(savedUser);
                        console.log('User loaded from localStorage:', currentUser);
                        return;
                    } catch (e) {
                        console.error('Error parsing saved user:', e);
                        localStorage.removeItem('rentrobe_user');
                    }
                }
                
                // If no saved user, try to fetch from server (for development)
                const response = await fetch('/api/profile', { credentials: 'include' });
                console.log('Profile response status:', response.status);
                
                if (response.ok) {
                    const user = await response.json();
                    console.log('Profile response data:', user);
                    
                    // Check if we have updated profile data in localStorage
                    const savedUser = localStorage.getItem('rentrobe_user');
                    if (savedUser) {
                        try {
                            const localUser = JSON.parse(savedUser);
                            // If the email matches, merge the data (localStorage has priority for profile fields)
                            if (localUser.email === user.email) {
                                console.log('Merging user data from localStorage with server data in fetchCurrentUser');
                                currentUser = {
                                    ...user, // Server data (has correct ID, password, etc.)
                                    name: localUser.name, // Local profile updates take priority
                                    phone: localUser.phone,
                                    city: localUser.city
                                };
                                console.log('Merged user data in fetchCurrentUser:', currentUser);
                            } else {
                                currentUser = user;
                            }
                        } catch (e) {
                            console.error('Error parsing saved user in fetchCurrentUser:', e);
                            currentUser = user;
                        }
                    } else {
                        currentUser = user;
                    }
                    
                    localStorage.setItem('rentrobe_user', JSON.stringify(currentUser));
                } else if (response.status === 401) {
                    console.log('Not authenticated (401)');
                    currentUser = null;
                    localStorage.removeItem('rentrobe_user');
                } else {
                    console.log('Profile fetch failed with status:', response.status);
                    const errorData = await response.json().catch(() => ({}));
                    console.log('Profile error data:', errorData);
                }
            } catch (e) {
                console.error('Profile fetch error:', e);
                // Network error: keep local state
                const savedUser = localStorage.getItem('rentrobe_user');
                if (savedUser) {
                    try {
                        currentUser = JSON.parse(savedUser);
                        console.log('Using cached user due to network error');
                    } catch (parseError) {
                        console.error('Error parsing cached user:', parseError);
                        localStorage.removeItem('rentrobe_user');
                        currentUser = null;
                    }
                }
            }
        }

        // Carousel functions
        function initializeCarousel() {
            const slides = document.querySelectorAll('.carousel-slide');
            
            if (slides.length === 0) return;
            
            // Start auto-slide
            startAutoSlide();
        }

        function startAutoSlide() {
            slideInterval = setInterval(() => {
                changeSlide(1);
            }, 3000); // Change slide every 3 seconds
        }

        function stopAutoSlide() {
            clearInterval(slideInterval);
        }

        function changeSlide(direction) {
            const slides = document.querySelectorAll('.carousel-slide');
            
            if (slides.length === 0) return;
            
            // Remove active class from current slide
            slides[currentSlideIndex].classList.remove('active');
            
            // Calculate new slide index
            currentSlideIndex += direction;
            
            // Handle wrap-around
            if (currentSlideIndex >= slides.length) {
                currentSlideIndex = 0;
            } else if (currentSlideIndex < 0) {
                currentSlideIndex = slides.length - 1;
            }
            
            // Add active class to new slide
            slides[currentSlideIndex].classList.add('active');
        }

        function currentSlide(slideNumber) {
            const slides = document.querySelectorAll('.carousel-slide');
            
            if (slides.length === 0) return;
            
            // Remove active class from current slide
            slides[currentSlideIndex].classList.remove('active');
            
            // Set new slide index
            currentSlideIndex = slideNumber - 1;
            
            // Add active class to new slide
            slides[currentSlideIndex].classList.add('active');
            
            // Restart auto-slide
            stopAutoSlide();
            startAutoSlide();
        }

        // Header scroll effect
        function initializeHeaderScroll() {
            const header = document.querySelector('header');
            
            function updateHeaderStyle() {
                // Remove all classes first
                header.classList.remove('scrolled');
                
                const scrollY = window.scrollY;
                
                // Apply scrolled effect if scrolled
                if (scrollY > 100) {
                    header.classList.add('scrolled');
                }
            }
            
            // Apply initial style immediately
            updateHeaderStyle();
            
            // Listen for scroll events
            window.addEventListener('scroll', updateHeaderStyle);
            
            // Listen for page changes (when switching tabs)
            window.addEventListener('popstate', updateHeaderStyle);
            
            // Also update when the page becomes visible (in case of tab switching)
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden) {
                    updateHeaderStyle();
                }
            });
        }

        function loadUserFromStorage() {
            const savedUser = localStorage.getItem('rentrobe_user');
            if (savedUser && savedUser !== 'undefined' && savedUser !== 'null') {
                try {
                    const user = JSON.parse(savedUser);
                    // Validate that user has required fields
                    if (user && user.id && user.name && user.email) {
                        currentUser = user;
                        console.log('Loaded user from storage:', user);
                        // For Netlify deployment, we rely on localStorage primarily
                        // Don't overwrite with server data unless necessary
                        return true; // Indicate we have a valid user from storage
                    } else {
                        console.log('Invalid user data in storage, clearing...');
                        localStorage.removeItem('rentrobe_user');
                        currentUser = null;
                    }
                } catch (error) {
                    console.error('Error parsing saved user:', error);
                    localStorage.removeItem('rentrobe_user');
                    currentUser = null;
                }
            } else {
                currentUser = null;
            }
            return false; // No valid user from storage
        }

        function initializeItems() {
            loadItems();
        }

        async function loadItems() {
            try {
                const resp = await fetch('/api/items');
                if (resp.ok) {
                    const data = await resp.json();
                    items = data.items || data;
                    filteredItems = [...items];
                } else {
                    items = [...sampleItems];
                    filteredItems = [...items];
                }
            } catch (e) {
                items = [...sampleItems];
                filteredItems = [...items];
            }
            
            // Apply initial sorting
            filteredItems = sortItems(filteredItems);
            
            renderFeaturedItems();
            renderAllItems();
        }

        async function loadItemsWithPagination(page = 1, filters = {}) {
            try {
                // Build query parameters
                const params = new URLSearchParams({
                    page: page,
                    per_page: itemsPerPage,
                    ...filters
                });
                
                const resp = await fetch(`/api/items?${params}`);
                if (resp.ok) {
                    const data = await resp.json();
                    return {
                        items: data.items || [],
                        pagination: data.pagination || {
                            page: 1,
                            pages: 1,
                            per_page: itemsPerPage,
                            total: data.items?.length || 0,
                            has_next: false,
                            has_prev: false
                        }
                    };
                } else {
                    throw new Error('API request failed');
                }
            } catch (e) {
                console.log('=== PAGINATION FALLBACK ===');
                console.log('Using fallback pagination, page:', page);
                console.log('Filtered items length:', filteredItems.length);
                console.log('Items length:', items.length);
                
                // Fallback to sample data with client-side pagination
                let itemsToUse = filteredItems.length > 0 ? filteredItems : items;
                console.log('Items to use length:', itemsToUse.length);
                console.log('First 3 before sorting in pagination:', itemsToUse.slice(0, 3).map(item => ({ title: item.title, price: item.price })));
                
                // Apply sorting to ALL items before pagination
                itemsToUse = sortItems(itemsToUse);
                console.log('First 3 after sorting in pagination:', itemsToUse.slice(0, 3).map(item => ({ title: item.title, price: item.price })));
                
                // Update the global filteredItems with sorted data
                filteredItems = itemsToUse;
                console.log('Updated global filteredItems');
                
                const startIndex = (page - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const paginatedItems = itemsToUse.slice(startIndex, endIndex);
                console.log('Paginated items for page', page, ':', paginatedItems.length);
                console.log('First 3 paginated items:', paginatedItems.slice(0, 3).map(item => ({ title: item.title, price: item.price })));
                
                return {
                    items: paginatedItems,
                    pagination: {
                        page: page,
                        pages: Math.ceil(itemsToUse.length / itemsPerPage),
                        per_page: itemsPerPage,
                        total: itemsToUse.length,
                        has_next: page < Math.ceil(itemsToUse.length / itemsPerPage),
                        has_prev: page > 1
                    }
                };
            }
        }

        function setupEventListeners() {
            // Navigation
            
            // Browse search - real-time search as user types
            document.getElementById('browseSearchInput').addEventListener('input', performBrowseSearch);

            // Forms
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                console.log('Login form found, adding event listener');
                loginForm.addEventListener('submit', handleLogin);
            } else {
                console.error('Login form not found!');
            }
            
            document.getElementById('signupForm').addEventListener('submit', handleSignup);
            document.getElementById('listForm').addEventListener('submit', handleListItem);
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);

            // File upload
            document.getElementById('itemImages').addEventListener('change', handleFileSelect);

            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                    // Restore body scrolling when modal is closed
                    document.body.style.overflow = 'auto';
                }
            });
        }

        // Navigation functions
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation active state
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Update mobile navigation active state
            document.querySelectorAll('.mobile-nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Highlight current page in navigation
            const currentLink = document.querySelector(`.nav-links a[onclick="showPage('${pageId}')"]`);
            if (currentLink) {
                currentLink.classList.add('active');
            }
            
            // Highlight current page in mobile navigation
            const currentMobileLink = document.querySelector(`.mobile-nav-links a[onclick*="showPage('${pageId}')"]`);
            if (currentMobileLink) {
                currentMobileLink.classList.add('active');
            }
            
            // Reset scroll to top
            window.scrollTo({
                top: 0,
                left: 0,
                behavior: 'smooth'
            });
            
            // Update header style when switching pages
            setTimeout(() => {
                const header = document.querySelector('header');
                
                // Remove all classes first
                header.classList.remove('scrolled');
                
                const scrollY = window.scrollY;
                
                // Apply scrolled effect if scrolled
                if (scrollY > 100) {
                    header.classList.add('scrolled');
                }
            }, 100);
            
            // Update content based on page
            if (pageId === 'browse') {
                renderAllItems();
            } else if (pageId === 'cart') {
                renderCart();
            } else if (pageId === 'list') {
                // List item page is always accessible, content will show login prompt if needed
            } else if (pageId === 'my-items' && currentUser) {
                loadMyItems();
            } else if (pageId === 'profile' && currentUser) {
                loadProfile();
            } else if ((pageId === 'my-items' || pageId === 'rentals' || pageId === 'profile') && !currentUser) {
                attemptedProtectedPage = pageId;
                showModal('loginModal');
                return;
            }
        }

        // Modal functions
        function showModal(modalId) {
            // Store current scroll position
            const scrollY = window.scrollY;
            
            document.getElementById(modalId).style.display = 'block';
            // Prevent body scrolling when modal is open
            document.body.style.overflow = 'hidden';
            
            // Clear any existing alerts in the modal
            const modal = document.getElementById(modalId);
            const alerts = modal.querySelectorAll('.alert');
            alerts.forEach(alert => alert.style.display = 'none');
            
            // Clear form fields for login modal
            if (modalId === 'loginModal') {
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
            }
            
            // Clear form fields for signup modal
            if (modalId === 'signupModal') {
                document.getElementById('signupName').value = '';
                document.getElementById('signupEmail').value = '';
                document.getElementById('signupPassword').value = '';
                document.getElementById('signupPhone').value = '';
                document.getElementById('signupCity').value = '';
            }
            
            // Restore scroll position after a brief delay
            setTimeout(() => {
                window.scrollTo(0, scrollY);
            }, 10);
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Restore body scrolling when modal is closed
            document.body.style.overflow = 'auto';
            // Clear alerts
            const modal = document.getElementById(modalId);
            const alerts = modal.querySelectorAll('.alert');
            alerts.forEach(alert => alert.style.display = 'none');
            
            // If login modal was closed without successful login and user was trying to access protected page
            if (modalId === 'loginModal' && attemptedProtectedPage && !currentUser) {
                // Redirect to home page
                showPage('home');
                attemptedProtectedPage = null;
            }
        }

        // User menu
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            console.log('=== MOBILE MENU TOGGLE CALLED ===');
            const mobileNav = document.getElementById('mobileNav');
            
            if (!mobileNav) {
                console.error('Mobile nav element not found!');
                return;
            }
            
            console.log('Mobile nav element found:', mobileNav);
            console.log('Current classes:', mobileNav.className);
            console.log('Current state:', mobileNav.classList.contains('active'));
            
            // Force toggle
            if (mobileNav.classList.contains('active')) {
                mobileNav.classList.remove('active');
                console.log('Removed active class');
            } else {
                mobileNav.classList.add('active');
                console.log('Added active class');
            }
            
            console.log('After toggle - classes:', mobileNav.className);
            console.log('After toggle - state:', mobileNav.classList.contains('active'));
            
            // Check computed styles
            const computedStyle = window.getComputedStyle(mobileNav);
            console.log('Mobile nav computed styles:', {
                display: computedStyle.display,
                visibility: computedStyle.visibility,
                opacity: computedStyle.opacity,
                transform: computedStyle.transform,
                position: computedStyle.position,
                top: computedStyle.top,
                left: computedStyle.left,
                right: computedStyle.right,
                bottom: computedStyle.bottom,
                zIndex: computedStyle.zIndex
            });
        }

        function closeMobileMenu() {
            const mobileNav = document.getElementById('mobileNav');
            mobileNav.classList.remove('active');
        }

        // Test function for debugging
        window.testMobileMenu = function() {
            console.log('=== TESTING MOBILE MENU ===');
            const mobileNav = document.getElementById('mobileNav');
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            
            console.log('Mobile nav element:', mobileNav);
            console.log('Mobile menu toggle element:', mobileMenuToggle);
            console.log('Mobile nav classes:', mobileNav ? mobileNav.className : 'NOT FOUND');
            console.log('Mobile menu toggle classes:', mobileMenuToggle ? mobileMenuToggle.className : 'NOT FOUND');
            
            if (mobileNav) {
                // Force show the mobile nav for testing
                mobileNav.style.display = 'block';
                mobileNav.style.visibility = 'visible';
                mobileNav.style.opacity = '1';
                mobileNav.style.transform = 'translateY(0)';
                mobileNav.classList.add('active');
                console.log('Force showed mobile nav for testing');
                console.log('Mobile nav computed styles:', {
                    display: window.getComputedStyle(mobileNav).display,
                    visibility: window.getComputedStyle(mobileNav).visibility,
                    opacity: window.getComputedStyle(mobileNav).opacity,
                    transform: window.getComputedStyle(mobileNav).transform
                });
                
                setTimeout(() => {
                    mobileNav.classList.remove('active');
                    mobileNav.style.display = '';
                    mobileNav.style.visibility = '';
                    mobileNav.style.opacity = '';
                    mobileNav.style.transform = '';
                    console.log('Reset mobile nav');
                }, 3000);
            }
        };

        // Test function for login API
        window.testLogin = async function(email = 'demo@wearhouse.com', password = 'password123') {
            console.log('=== TESTING LOGIN API ===');
            console.log('Testing with:', { email, password: password ? '***' : 'empty' });
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password }),
                    credentials: 'include'
                });
                
                console.log('Login test response status:', response.status);
                console.log('Login test response ok:', response.ok);
                
                const data = await response.json();
                console.log('Login test response data:', data);
                
                if (response.ok && data.user) {
                    console.log('Login test successful!');
                    return data;
                } else {
                    console.log('Login test failed:', data);
                    return null;
                }
            } catch (error) {
                console.error('Login test error:', error);
                return null;
            }
        };

        // Add event listener for mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded - Setting up mobile menu');
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            if (mobileMenuToggle) {
                console.log('Mobile menu toggle button found:', mobileMenuToggle);
                mobileMenuToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Mobile menu toggle clicked via event listener');
                    toggleMobileMenu();
                });
            } else {
                console.error('Mobile menu toggle button not found!');
            }
        });

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const mobileNav = document.getElementById('mobileNav');
            const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
            
            if (mobileNav && mobileNav.classList.contains('active')) {
                if (!mobileNav.contains(event.target) && !mobileMenuToggle.contains(event.target)) {
                    mobileNav.classList.remove('active');
                }
            }
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-menu')) {
                document.getElementById('userDropdown').classList.remove('show');
            }
        });

        // Auth functions
        async function handleLogin(e) {
            e.preventDefault();
            console.log('=== LOGIN ATTEMPT STARTED ===');
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            console.log('Login credentials:', { email, password: password ? '***' : 'empty' });

            if (!email || !password) {
                console.error('Missing email or password');
                showAlert('loginError');
                return;
            }

            showSpinner('loginSpinner');

            try {
                console.log('Attempting login API call...');
                // Try API first
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password }),
                    credentials: 'include'
                });

                console.log('Login response status:', response.status);
                console.log('Login response ok:', response.ok);

                if (response.ok) {
                    const data = await response.json();
                    console.log('Login response data:', data);
                    
                    if (data.user) {
                        // Check if we have updated profile data in localStorage
                        const savedUser = localStorage.getItem('rentrobe_user');
                        if (savedUser) {
                            try {
                                const localUser = JSON.parse(savedUser);
                                // If the email matches, merge the data (localStorage has priority for profile fields)
                                if (localUser.email === data.user.email) {
                                    console.log('Merging user data from localStorage with server data');
                                    currentUser = {
                                        ...data.user, // Server data (has correct ID, password, etc.)
                                        name: localUser.name, // Local profile updates take priority
                                        phone: localUser.phone,
                                        city: localUser.city
                                    };
                                    console.log('Merged user data:', currentUser);
                                } else {
                                    currentUser = data.user;
                                }
                            } catch (e) {
                                console.error('Error parsing saved user during login:', e);
                                currentUser = data.user;
                            }
                        } else {
                            currentUser = data.user;
                        }
                        
                        console.log('Current user set to:', currentUser);
                        localStorage.setItem('rentrobe_user', JSON.stringify(currentUser));
                        console.log('User saved to localStorage');
                        
                        updateAuthUI();
                        console.log('Auth UI updated');
                        
                        hideModal('loginModal');
                        hideSpinner('loginSpinner');
                        console.log('Login successful - modal closed');
                        
                        // Update UI immediately since we're using localStorage
                        updateAuthUI();
                        
                        // Redirect to intended page if user was trying to access protected page
                        if (attemptedProtectedPage) {
                            showPage(attemptedProtectedPage);
                            attemptedProtectedPage = null;
                        }
                    } else {
                        console.error('No user data in response:', data);
                        showAlert('loginError');
                        hideSpinner('loginSpinner');
                    }
                } else {
                    const errorData = await response.json();
                    console.error('Login API error:', errorData);
                    showAlert('loginError');
                    hideSpinner('loginSpinner');
                }
            } catch (error) {
                console.error('Login network error:', error);
                showAlert('loginError');
                hideSpinner('loginSpinner');
            }
        }

        async function handleSignup(e) {
            e.preventDefault();
            console.log('Signup form submitted');
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const phone = document.getElementById('signupPhone').value;
            const city = document.getElementById('signupCity').value;

            console.log('Signup data:', { name, email, phone, city });

            if (!name || !email || !password || !phone || !city) {
                console.log('Missing required fields');
                showAlert('signupError');
                return;
            }

            showSpinner('signupSpinner');

            try {
                // Try API first
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password, phone, city }),
                    credentials: 'include'
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('Signup response data:', data);
                    currentUser = data.user;
                    console.log('Current user set to:', currentUser);
                    localStorage.setItem('rentrobe_user', JSON.stringify(currentUser));
                    console.log('User saved to localStorage');
                    updateAuthUI();
                    console.log('Auth UI updated');
                    hideModal('signupModal');
                    hideSpinner('signupSpinner');
                    console.log('Registration completed successfully');
                    
                    // Update UI immediately since we're using localStorage
                    updateAuthUI();
                    
                    // Redirect to intended page if user was trying to access protected page
                    if (attemptedProtectedPage) {
                        showPage(attemptedProtectedPage);
                        attemptedProtectedPage = null;
                    }
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    showAlert('signupError');
                    if (errorData && errorData.error) {
                        const el = document.getElementById('signupError');
                        if (el) el.textContent = errorData.error;
                    }
                    hideSpinner('signupSpinner');
                    return;
                }
            } catch (error) {
                showAlert('signupError');
                hideSpinner('signupSpinner');
                return;
            }
            hideSpinner('signupSpinner');
        }

        async function logout() {
            try {
                await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });
            } catch (e) {
                // ignore network errors on logout
            }
            currentUser = null;
            localStorage.removeItem('rentrobe_user');
            updateAuthUI();
            showPage('home');
        }

        function updateAuthUI() {
            console.log('updateAuthUI called, currentUser:', currentUser);
            const authButtons = document.getElementById('authButtons');
            const userMenu = document.getElementById('userMenu');
            const mobileUserSection = document.getElementById('mobileUserSection');
            const mobileProfileLink = document.getElementById('mobileProfileLink');
            const mobileLogoutLink = document.getElementById('mobileLogoutLink');
            const mobileMyItemsLink = document.getElementById('mobileMyItemsLink');
            
            // Login prompts for protected pages
            const listLoginPrompt = document.getElementById('listLoginPrompt');
            const listFormContainer = document.getElementById('listFormContainer');
            const cartLoginPrompt = document.getElementById('cartLoginPrompt');
            const cartContainer = document.getElementById('cartContainer');
            
            console.log('authButtons element:', authButtons);
            console.log('userMenu element:', userMenu);

            // Check if user has valid data
            if (currentUser && currentUser.id && currentUser.name && currentUser.email) {
                console.log('Setting logged in state');
                authButtons.style.display = 'none';
                userMenu.style.display = 'flex';
                if (mobileUserSection) mobileUserSection.style.display = 'block';
                if (mobileProfileLink) mobileProfileLink.style.display = 'block';
                if (mobileLogoutLink) mobileLogoutLink.style.display = 'block';
                if (mobileMyItemsLink) mobileMyItemsLink.style.display = 'block';
                
                // Show form content, hide login prompts
                if (listLoginPrompt) listLoginPrompt.style.display = 'none';
                if (listFormContainer) listFormContainer.style.display = 'block';
                if (cartLoginPrompt) cartLoginPrompt.style.display = 'none';
                if (cartContainer) cartContainer.style.display = 'block';
                
                const userInitial = document.getElementById('userInitial');
                if (userInitial && currentUser.name) {
                    userInitial.textContent = currentUser.name.charAt(0).toUpperCase();
                }
                
                // Update mobile user info
                const mobileUserInitial = document.getElementById('mobileUserInitial');
                const mobileUserName = document.getElementById('mobileUserName');
                const mobileUserEmail = document.getElementById('mobileUserEmail');
                
                if (mobileUserInitial && currentUser.name) {
                    mobileUserInitial.textContent = currentUser.name.charAt(0).toUpperCase();
                }
                if (mobileUserName) {
                    mobileUserName.textContent = currentUser.name;
                }
                if (mobileUserEmail) {
                    mobileUserEmail.textContent = currentUser.email;
                }
            } else {
                console.log('Setting logged out state - invalid or missing user data');
                // Clear invalid user data
                if (currentUser && (!currentUser.id || !currentUser.name || !currentUser.email)) {
                    console.log('Clearing invalid user data');
                    currentUser = null;
                    localStorage.removeItem('rentrobe_user');
                }
                authButtons.style.display = 'flex';
                userMenu.style.display = 'none';
                if (mobileUserSection) mobileUserSection.style.display = 'none';
                if (mobileProfileLink) mobileProfileLink.style.display = 'none';
                if (mobileLogoutLink) mobileLogoutLink.style.display = 'none';
                if (mobileMyItemsLink) mobileMyItemsLink.style.display = 'none';
                
                // Show login prompts, hide form content
                if (listLoginPrompt) listLoginPrompt.style.display = 'block';
                if (listFormContainer) listFormContainer.style.display = 'none';
                if (cartLoginPrompt) cartLoginPrompt.style.display = 'block';
                if (cartContainer) cartContainer.style.display = 'none';
            }
        }

        // Cart functionality
        let cart = JSON.parse(localStorage.getItem('rentrobe_cart') || '[]');


        function addToCart(item) {
            if (!currentUser) {
                showModal('loginModal');
                return;
            }
            
            // Check if item is already in cart
            const existingItem = cart.find(cartItem => cartItem.id === item.id);
            if (existingItem) {
                showAlert('Item already in cart');
                return;
            }
            
            cart.push(item);
            localStorage.setItem('rentrobe_cart', JSON.stringify(cart));
            showAlert('Item added to cart');
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            localStorage.setItem('rentrobe_cart', JSON.stringify(cart));
            renderCart();
        }

        function renderCart() {
            const container = document.getElementById('cartContainer');
            if (!container) return;
            
            // If user is not logged in, don't render cart content
            if (!currentUser) {
                return;
            }
            
            if (cart.length === 0) {
                container.innerHTML = `
<div class="empty-cart" style="text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;"></div>
                        <h3 style="color: var(--gray-600); margin-bottom: 10px;">Your cart is empty</h3>
                        <p style="color: var(--gray-500); margin-bottom: 30px;">Start browsing to add items to your cart</p>
                        <a href="#" class="btn btn-primary" onclick="showPage('browse')">Browse Items</a>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = `
                <div class="cart-items">
                    ${cart.map(item => `
                        <div class="cart-item" style="display: flex; align-items: center; padding: 20px; border: 1px solid var(--gray-200); border-radius: 8px; margin-bottom: 16px;">
                            <img src="${item.image}" alt="${item.title}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 8px 0; color: var(--black);">${item.title}</h4>
                                <p style="margin: 0 0 8px 0; color: var(--gray-600);">${item.description}</p>
                                <p style="margin: 0; font-weight: 600; color: var(--black);">$${item.price}/day</p>
                            </div>
                            <button onclick="removeFromCart(${item.id})" class="btn" style="background: #e74c3c; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Remove</button>
                        </div>
                    `).join('')}
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="proceedToCheckout()" style="padding: 12px 24px; font-size: 16px;">Proceed to Checkout</button>
                </div>
            `;
        }

        function proceedToCheckout() {
            if (cart.length === 0) {
                showAlert('Your cart is empty');
                return;
            }
            // For now, just show an alert. In a real app, this would redirect to checkout
            showAlert('Checkout functionality coming soon!');
        }


        // Item management
        async function handleListItem(e) {
            e.preventDefault();

            if (!currentUser) {
                showModal('loginModal');
                return;
            }

            const title = document.getElementById('itemTitle').value;
            const description = document.getElementById('itemDescription').value;
            const category = document.getElementById('itemCategory').value;
            const size = document.getElementById('itemSize').value;
            const price = parseInt(document.getElementById('itemPrice').value);
            const deposit = parseInt(document.getElementById('itemDeposit').value);

            if (!title || !description || !category || !size || !price || !deposit) {
                showAlert('listError');
                return;
            }

            showSpinner('listSpinner');

            // Map category to category_id via API (fallback to 1)
            let categoryId = 1;
            try {
                const catsResp = await fetch('/api/categories');
                if (catsResp.ok) {
                    const cats = await catsResp.json();
                    const match = cats.find(c => (c.slug || '').toLowerCase() === category.toLowerCase());
                    if (match) categoryId = match.id;
                }
            } catch (e) {}

            try {
                const createResp = await fetch('/api/items', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({
                        title,
                        description,
                        category_id: categoryId,
                        size,
                        price_per_day: price,
                        security_deposit: deposit
                    })
                });

                if (!createResp.ok) {
                    const err = await createResp.json().catch(() => ({}));
                    const listErr = document.getElementById('listError');
                    if (listErr && err.error) listErr.textContent = err.error;
                    showAlert('listError');
                    hideSpinner('listSpinner');
                    return;
                }

                const created = await createResp.json();
                const itemId = created.item_id;

                // Upload images if any
                const files = document.getElementById('itemImages').files;
                if (files && files.length > 0) {
                    const formData = new FormData();
                    for (let i = 0; i < Math.min(files.length, 5); i++) {
                        formData.append('images', files[i]);
                    }
                    await fetch(`/api/items/${itemId}/upload`, {
                        method: 'POST',
                        credentials: 'include',
                        body: formData
                    });
                }

                // Reset form and reload items
                document.getElementById('listForm').reset();
                showAlert('listSuccess');
                await loadItems();
            } catch (err) {
                showAlert('listError');
            }
            hideSpinner('listSpinner');
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            const fileInfo = e.target.parentElement.querySelector('p');
            
            if (files.length > 0) {
                fileInfo.textContent = `${files.length} file(s) selected`;
            } else {
                fileInfo.textContent = 'Click to upload images';
            }
        }

        // Search and filter

        async function performBrowseSearch() {
            resetPagination();
            await renderAllItems();
        }

        function filterByCategory(category) {
            document.getElementById('categoryFilter').value = category;
            showPage('browse');
            applyFilters();
        }

        async function applyFilters() {
            // Get current filter values
            const category = document.getElementById('categoryFilter').value;
            const search = document.getElementById('browseSearchInput').value;
            
            // Apply filters
            filteredItems = [...items];
            
            if (category) {
                filteredItems = filteredItems.filter(item => item.category === category);
            }
            
            if (size) {
                filteredItems = filteredItems.filter(item => item.size === size);
            }
            
            if (city) {
                filteredItems = filteredItems.filter(item => 
                    item.owner && item.owner.city && 
                    item.owner.city.toLowerCase().includes(city.toLowerCase())
                );
            }
            
            if (search) {
                filteredItems = filteredItems.filter(item => 
                    item.title.toLowerCase().includes(search.toLowerCase()) ||
                    item.description.toLowerCase().includes(search.toLowerCase()) ||
                    item.category.toLowerCase().includes(search.toLowerCase())
                );
            }
            
            // Apply sorting
            filteredItems = sortItems(filteredItems);
            
            resetPagination();
            await renderAllItems();
        }

        async function clearFilters() {
            document.getElementById('categoryFilter').value = '';
            document.getElementById('browseSearchInput').value = '';
            document.getElementById('sortFilter').value = 'price-low';
            currentSort = 'price-low';
            filteredItems = [...items];
            resetPagination();
            await renderAllItems();
        }

        // Rendering functions
        function renderFeaturedItems() {
            const container = document.getElementById('featuredItems');
            
            // Randomize the featured items selection
            const shuffled = [...items].sort(() => Math.random() - 0.5);
            const featured = shuffled.slice(0, 4);
            
            renderItemsInContainer(featured, container);
        }

        async function renderAllItems() {
            const container = document.getElementById('allItems');
            
            // Show loading state
            container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--theme-accent);">Loading items...</div>';
            
            try {
                // Get current filters
                const filters = getCurrentFilters();
                
                // Load items with pagination from backend
                const result = await loadItemsWithPagination(currentPage, filters);
                
                // Update global pagination variables
                totalPages = result.pagination.pages;
                
                // Render items
                renderItemsInContainer(result.items, container);
                
                // Update pagination controls with backend data
                updatePaginationControlsWithBackendData(result.pagination);
                
            } catch (error) {
                console.error('Error loading items:', error);
                // Fallback to simple rendering with filteredItems
                if (filteredItems && filteredItems.length > 0) {
                    // Apply sorting to filtered items before rendering
                    const sortedItems = sortItems(filteredItems);
                    renderItemsInContainer(sortedItems, container);
                } else if (items && items.length > 0) {
                    // Apply sorting to all items before rendering
                    const sortedItems = sortItems(items);
                    renderItemsInContainer(sortedItems, container);
                } else {
                    container.innerHTML = '<p style="text-align: center; color: var(--gray-600); grid-column: 1/-1;">No items available.</p>';
                }
            }
        }

        function updatePaginationControlsWithBackendData(paginationData) {
            const paginationContainer = document.getElementById('paginationContainer');
            const paginationNumbers = document.getElementById('paginationNumbers');
            const paginationInfo = document.getElementById('paginationInfo');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            // Show/hide pagination container
            if (paginationData.pages <= 1) {
                paginationContainer.style.display = 'none';
                return;
            } else {
                paginationContainer.style.display = 'flex';
            }
            
            // Update prev/next buttons
            prevBtn.disabled = !paginationData.has_prev;
            nextBtn.disabled = !paginationData.has_next;
            
            // Generate page numbers
            paginationNumbers.innerHTML = generatePageNumbers();
            
            // Update pagination info with backend data
            const startItem = (paginationData.page - 1) * paginationData.per_page + 1;
            const endItem = Math.min(paginationData.page * paginationData.per_page, paginationData.total);
            paginationInfo.innerHTML = `Showing ${startItem}-${endItem} of ${paginationData.total} items`;
        }

        function updatePaginationControls(totalPages) {
            const paginationContainer = document.getElementById('paginationContainer');
            const paginationNumbers = document.getElementById('paginationNumbers');
            const paginationInfo = document.getElementById('paginationInfo');
            
            if (!paginationContainer || !paginationNumbers || !paginationInfo) return;
            
            // Show pagination if there are multiple pages
            if (totalPages > 1) {
                paginationContainer.style.display = 'flex';
                
                // Update pagination info
                const totalItems = filteredItems.length;
                paginationInfo.textContent = `Page ${currentPage} of ${totalPages} (${totalItems} items)`;
                
                // Clear existing page numbers
                paginationNumbers.innerHTML = '';
                
                // Previous button
                const prevButton = document.createElement('button');
                prevButton.className = 'pagination-btn';
                prevButton.innerHTML = '';
                prevButton.disabled = currentPage <= 1;
                prevButton.onclick = () => {
                    if (currentPage > 1) {
                        currentPage--;
                        renderSortedItems();
                    }
                };
                paginationNumbers.appendChild(prevButton);
                
                // Page numbers
                const startPage = Math.max(1, currentPage - 2);
                const endPage = Math.min(totalPages, currentPage + 2);
                
                for (let i = startPage; i <= endPage; i++) {
                    const pageButton = document.createElement('button');
                    pageButton.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
                    pageButton.textContent = i;
                    pageButton.onclick = () => {
                        currentPage = i;
                        renderSortedItems();
                    };
                    paginationNumbers.appendChild(pageButton);
                }
                
                // Next button
                const nextButton = document.createElement('button');
                nextButton.className = 'pagination-btn';
                nextButton.innerHTML = '';
                nextButton.disabled = currentPage >= totalPages;
                nextButton.onclick = () => {
                    if (currentPage < totalPages) {
                        currentPage++;
                        renderSortedItems();
                    }
                };
                paginationNumbers.appendChild(nextButton);
            } else {
                paginationContainer.style.display = 'none';
            }
        }

        function renderSortedItems() {
            const container = document.getElementById('allItems');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedItems = filteredItems.slice(startIndex, endIndex);
            
            console.log(`Page ${currentPage}: Showing items ${startIndex + 1}-${endIndex} of ${filteredItems.length} total items`);
            console.log(`Page ${currentPage} items:`, paginatedItems.map(item => ({ title: item.title, price: item.price })));
            
            renderItemsInContainer(paginatedItems, container);
            
            // Update pagination controls
            const totalPages = Math.ceil(filteredItems.length / itemsPerPage);
            updatePaginationControls(totalPages);
        }

        function getCurrentFilters() {
            const category = document.getElementById('categoryFilter').value;
            const search = document.getElementById('browseSearchInput').value;
            
            const filters = {};
            if (category) filters.category = category;
            if (search) filters.search = search;
            
            return filters;
        }

        // Helper function to generate consistent image URLs
        function getImageUrl(imagePath) {
            if (!imagePath) return '';
            if (typeof imagePath === 'string' && (imagePath.startsWith('http://') || imagePath.startsWith('https://'))) {
                return imagePath;
            }
            return `/static/uploads/${imagePath}`;
        }


        // Sorting functions
        function applySorting() {
            const sortValue = document.getElementById('sortFilter').value;
            currentSort = sortValue;
            
            // Get the base items (either filtered or all items)
            let baseItems = filteredItems.length > 0 ? filteredItems : items;
            
            console.log(`Sorting ${baseItems.length} items by: ${sortValue}`);
            console.log('First 3 items before sorting:', baseItems.slice(0, 3).map(item => ({ title: item.title, price: item.price })));
            
            // Apply sorting to the base items
            const sortedItems = sortItems([...baseItems]);
            
            console.log('First 3 items after sorting:', sortedItems.slice(0, 3).map(item => ({ title: item.title, price: item.price })));
            console.log('Last 3 items after sorting:', sortedItems.slice(-3).map(item => ({ title: item.title, price: item.price })));
            
            // Update the global filteredItems with sorted data
            filteredItems = sortedItems;
            
            // Reset to page 1 when sorting changes
            currentPage = 1;
            
            // Render items directly with pagination
            const container = document.getElementById('allItems');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedItems = sortedItems.slice(startIndex, endIndex);
            
            console.log(`Showing items ${startIndex + 1}-${endIndex} of ${sortedItems.length} total items`);
            console.log('Page 1 items:', paginatedItems.map(item => ({ title: item.title, price: item.price })));
            
            renderItemsInContainer(paginatedItems, container);
            
            // Update pagination controls
            const totalPages = Math.ceil(sortedItems.length / itemsPerPage);
            updatePaginationControls(totalPages);
        }

        function sortItems(itemsToSort) {
            if (!itemsToSort || itemsToSort.length === 0) {
                return itemsToSort;
            }
            
            const sortedItems = [...itemsToSort];
            
            switch (currentSort) {
                case 'newest':
                    return sortedItems.sort((a, b) => {
                        const dateA = new Date(a.date_added || 0);
                        const dateB = new Date(b.date_added || 0);
                        return dateB - dateA;
                    });
                
                case 'oldest':
                    return sortedItems.sort((a, b) => {
                        const dateA = new Date(a.date_added || 0);
                        const dateB = new Date(b.date_added || 0);
                        return dateA - dateB;
                    });
                
                case 'price-low':
                    return sortedItems.sort((a, b) => (a.price || 0) - (b.price || 0));
                
                case 'price-high':
                    return sortedItems.sort((a, b) => (b.price || 0) - (a.price || 0));
                
                case 'name-asc':
                    return sortedItems.sort((a, b) => {
                        const nameA = (a.title || '').toLowerCase();
                        const nameB = (b.title || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                
                case 'name-desc':
                    return sortedItems.sort((a, b) => {
                        const nameA = (a.title || '').toLowerCase();
                        const nameB = (b.title || '').toLowerCase();
                        return nameB.localeCompare(nameA);
                    });
                
                case 'rating':
                    return sortedItems.sort((a, b) => (b.rating || 0) - (a.rating || 0));
                
                case 'views':
                    return sortedItems.sort((a, b) => (b.views || 0) - (a.views || 0));
                
                default:
                    return sortedItems;
            }
        }


        function renderItemsInContainer(itemsToRender, container, isMyItems = false) {
            if (itemsToRender.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--gray-600); grid-column: 1/-1;">No items found.</p>';
                return;
            }

            container.innerHTML = itemsToRender.map(item => {
                // Always try to get the original item data from sampleItems to ensure consistency
                const originalItem = sampleItems.find(i => i.id === item.id) || item;
                
                const hasImages = originalItem.images && originalItem.images.length > 0;
                const firstImageUrl = hasImages ? getImageUrl(originalItem.images[0]) : '';
                const secondImageUrl = hasImages && originalItem.images.length > 1 ? getImageUrl(originalItem.images[1]) : '';
                
                // Debug: Log the item data for cards
                console.log('Item data for card:', {
                    id: originalItem.id,
                    title: originalItem.title,
                    images: originalItem.images,
                    firstImageUrl: firstImageUrl,
                    source: sampleItems.find(i => i.id === item.id) ? 'sampleItems' : 'items'
                });
                
                // Add delete button for My Items section
                const deleteButton = isMyItems ? `
                    <div class="item-actions" style="position: absolute; top: 8px; right: 8px; z-index: 10;">
                        <button onclick="event.stopPropagation(); deleteItem(${originalItem.id})" 
                                class="btn" 
                                style="background: #e74c3c; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;"
                                title="Delete item">
                            Delete
                        </button>
                    </div>
                ` : '';
                
                return `
                <div class="item-card" onclick="${isMyItems ? '' : `showItemModal(${originalItem.id})`}" style="position: relative;">
                    ${deleteButton}
                    <div class="item-image">
                        ${hasImages ? 
                            `<img src="${firstImageUrl}" alt="${originalItem.title}" class="default-image" loading="lazy" decoding="async" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                             ${secondImageUrl ? `<img src="${secondImageUrl}" alt="${originalItem.title}" class="hover-image" loading="lazy" decoding="async" onerror="this.style.display='none';">` : ''}
                             <div class="image-fallback" style="display: none;"></div>` : 
                            '<div class="image-fallback"></div>'
                        }
                        <div class="item-status">${originalItem.status === 'available' ? 'Available' : 'Rented'}</div>
                    </div>
                    <div class="item-content">
                        <h3 class="item-title">${originalItem.title}</h3>
                        <p class="item-description">${originalItem.description.substring(0, 60)}...</p>
                        <div class="item-details">
                            <span class="item-price">${originalItem.price}/day</span>
                            <span class="item-size">${originalItem.size}</span>
                        </div>
                        <div class="item-owner">
                            <div class="owner-avatar">${originalItem.owner && (originalItem.owner.initial || (originalItem.owner.name ? originalItem.owner.name.charAt(0).toUpperCase() : 'U'))}</div>
                            <span>${originalItem.owner ? `${originalItem.owner.name}  ${originalItem.owner.city || ''}` : ''}</span>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        function showItemModal(itemId) {
            // Always try to find in sample data first to ensure we get the original data
            let item = sampleItems.find(i => i.id === itemId);
            
            // If not found in sample data, try current items array
            if (!item) {
                item = items.find(i => i.id === itemId);
            }
            
            if (!item) {
                return;
            }

            // Debug: Log the item data to see what images it has
            console.log('Item data for modal:', {
                id: item.id,
                title: item.title,
                images: item.images,
                firstImageUrl: getImageUrl(item.images[0]),
                source: sampleItems.find(i => i.id === itemId) ? 'sampleItems' : 'items'
            });

            const modalContent = document.getElementById('itemModalContent');
            const imageGallery = item.images && item.images.length > 0 ? 
                `<div class="image-gallery" style="margin-bottom: 20px;">
                    <div class="main-image" style="width: 100%; max-width: 300px; aspect-ratio: 1 / 1; border-radius: 8px; overflow: hidden; margin: 0 auto 12px; position: relative; background: var(--gray-100);">
                        <img src="${getImageUrl(item.images[0])}" alt="${item.title}" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="image-fallback" style="display: none; width: 100%; height: 100%; background: var(--gray-100); align-items: center; justify-content: center; font-size: 48px; color: var(--gray-500);"></div>
                    </div>
                    ${item.images.length > 1 ? `
                        <div class="thumbnail-gallery" style="display: flex; gap: 8px; overflow-x: auto;">
                            ${item.images.map((img, index) => `
                                <img src="${getImageUrl(img)}" alt="${item.title} ${index + 1}" 
                                     style="width: 60px; height: 60px; object-fit: cover; border-radius: 4px; cursor: pointer; border: 2px solid transparent;"
                                     onclick="changeMainImage('${img}', this)"
                                     onmouseover="this.style.borderColor='var(--gray-300)'"
                                     onmouseout="this.style.borderColor='transparent'">
                            `).join('')}
                        </div>
                    ` : ''}
                </div>` : 
                `<div style="width: 100%; max-width: 300px; aspect-ratio: 1 / 1; background: var(--gray-100); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 48px; color: var(--gray-500); margin: 0 auto 20px;"></div>`;

            const isOwner = currentUser && item.owner && item.owner.id && currentUser.id === item.owner.id;
            modalContent.innerHTML = `
                <h2>${item.title}</h2>
                <div style="margin: 20px 0;">
                    ${imageGallery}
                    <p style="margin-bottom: 16px; line-height: 1.6;">${item.description}</p>
                    <div style="margin-bottom: 12px;"><strong>Category:</strong> ${getCategoryName(item.category)}</div>
                    <div style="margin-bottom: 12px;"><strong>Size:</strong> ${item.size}</div>
                    <div style="margin-bottom: 12px;"><strong>Price:</strong> ${item.price}/day</div>
                    <div style="margin-bottom: 12px;"><strong>Deposit:</strong> ${item.deposit}</div>
                    <div style="margin-bottom: 20px;"><strong>Owner:</strong> ${item.owner.name} (${item.owner.city})</div>
                    
                    ${item.status === 'available' && currentUser && !isOwner ? `
                        <div style=\"display: flex; gap: 12px; margin-bottom: 12px;\">
                            <button class=\"btn btn-primary\" style=\"flex: 1;\" onclick=\"openRentalModal(${item.id})\">Request Rental</button>
                            <button class=\"btn\" style=\"flex: 1; border-color: var(--theme-accent); color: var(--theme-accent);\" onclick=\"addToCart(${JSON.stringify(item).replace(/\\\"/g, '&quot;')}); hideModal('itemModal');\">Add to Cart</button>
                        </div>
                    ` : item.status === 'available' && isOwner ? `
                        <button class="btn" disabled style="width: 100%;">
                            Your Item
                        </button>
                    ` : item.status === 'available' && !currentUser ? `
                        <div style=\"display: flex; gap: 12px; margin-bottom: 12px;\">
                            <button class=\"btn btn-primary\" style=\"flex: 1;\" onclick=\"hideModal('itemModal'); showModal('loginModal');\">Sign In to Rent</button>
                            <button class=\"btn\" style=\"flex: 1; border-color: var(--theme-accent); color: var(--theme-accent);\" onclick=\"hideModal('itemModal'); showModal('loginModal');\">Add to Cart</button>
                        </div>
                    ` : `
                        <button class="btn" disabled style="width: 100%;">
                            Currently Rented
                        </button>
                    `}
                </div>
            `;

            showModal('itemModal');
        }

        // Pagination functions
        function updatePaginationControls() {
            const paginationContainer = document.getElementById('paginationContainer');
            const paginationNumbers = document.getElementById('paginationNumbers');
            const paginationInfo = document.getElementById('paginationInfo');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            // Show/hide pagination container
            if (totalPages <= 1) {
                paginationContainer.style.display = 'none';
                return;
            } else {
                paginationContainer.style.display = 'flex';
            }
            
            // Update prev/next buttons
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
            
            // Generate page numbers
            paginationNumbers.innerHTML = generatePageNumbers();
            
            // Update pagination info - this will be updated by the backend response
            // For now, show basic info
            const startItem = (currentPage - 1) * itemsPerPage + 1;
            const endItem = currentPage * itemsPerPage;
            paginationInfo.innerHTML = `Page ${currentPage} of ${totalPages}`;
        }

        function generatePageNumbers() {
            let html = '';
            const maxVisiblePages = 7;
            
            if (totalPages <= maxVisiblePages) {
                // Show all pages if total pages is small
                for (let i = 1; i <= totalPages; i++) {
                    html += `<button class="pagination-number ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
                }
            } else {
                // Show first page
                html += `<button class="pagination-number ${1 === currentPage ? 'active' : ''}" onclick="changePage(1)">1</button>`;
                
                if (currentPage > 4) {
                    html += '<div class="pagination-ellipsis">...</div>';
                }
                
                // Show pages around current page
                const start = Math.max(2, currentPage - 2);
                const end = Math.min(totalPages - 1, currentPage + 2);
                
                for (let i = start; i <= end; i++) {
                    html += `<button class="pagination-number ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
                }
                
                if (currentPage < totalPages - 3) {
                    html += '<div class="pagination-ellipsis">...</div>';
                }
                
                // Show last page
                if (totalPages > 1) {
                    html += `<button class="pagination-number ${totalPages === currentPage ? 'active' : ''}" onclick="changePage(${totalPages})">${totalPages}</button>`;
                }
            }
            
            return html;
        }

        async function changePage(page) {
            if (page < 1 || page > totalPages || page === currentPage) return;
            
            currentPage = page;
            await renderAllItems();
            
            // Fully reset scroll to top of page
            window.scrollTo({ 
                top: 0, 
                behavior: 'smooth' 
            });
        }

        function resetPagination() {
            currentPage = 1;
        }

        function getCategoryName(category) {
            const categoryNames = {
                formal: 'Formal Wear',
                casual: 'Casual Wear',
                party: 'Party Outfits',
                traditional: 'Traditional',
                designer: 'Designer'
            };
            return categoryNames[category] || category;
        }

        // Rental flow
        function openRentalModal(itemId) {
            const today = new Date().toISOString().split('T')[0];
            const startEl = document.getElementById('rentalStart');
            const endEl = document.getElementById('rentalEnd');
            document.getElementById('rentalItemId').value = itemId;
            if (startEl) startEl.min = today;
            if (endEl) endEl.min = today;
            hideModal('itemModal');
            showModal('rentalModal');
        }

        function validateRentalDates() {
            const start = document.getElementById('rentalStart').value;
            const end = document.getElementById('rentalEnd').value;
            if (start && end && end <= start) {
                const s = new Date(start);
                const next = new Date(s.getTime() + 24*60*60*1000);
                document.getElementById('rentalEnd').value = next.toISOString().split('T')[0];
            }
        }

        async function handleRentalSubmit(e) {
            e.preventDefault();
            if (!currentUser) {
                hideModal('rentalModal');
                showModal('loginModal');
                return;
            }

            const itemId = parseInt(document.getElementById('rentalItemId').value, 10);
            const startDate = document.getElementById('rentalStart').value;
            const endDate = document.getElementById('rentalEnd').value;
            const message = document.getElementById('rentalMessage').value || '';

            if (!itemId || !startDate || !endDate) {
                showAlert('rentalError');
                return;
            }

            showSpinner('rentalSpinner');
            try {
                const resp = await fetch('/api/rentals', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ item_id: itemId, start_date: startDate, end_date: endDate, message })
                });
                if (resp.ok) {
                    showAlert('rentalSuccess');
                    // Reload items to reflect status if needed
                    await loadItems();
                    setTimeout(() => hideModal('rentalModal'), 1200);
                } else {
                    const data = await resp.json().catch(() => ({}));
                    const el = document.getElementById('rentalError');
                    if (el && data.error) el.textContent = data.error;
                    showAlert('rentalError');
                }
            } catch (err) {
                showAlert('rentalError');
            }
            hideSpinner('rentalSpinner');
        }

        function changeMainImage(imageSrc, thumbnail) {
            const mainImage = document.querySelector('.main-image img');
            if (mainImage) {
                mainImage.src = imageSrc;
                // Update thumbnail borders
                document.querySelectorAll('.thumbnail-gallery img').forEach(img => {
                    img.style.borderColor = 'transparent';
                });
                thumbnail.style.borderColor = 'var(--black)';
            }
        }

        // Profile functions
        function loadProfile() {
            if (!currentUser) return;
            
            document.getElementById('profileName').value = currentUser.name || '';
            document.getElementById('profileEmail').value = currentUser.email || '';
            document.getElementById('profilePhone').value = currentUser.phone || '';
            document.getElementById('profileCity').value = currentUser.city || '';
        }

        async function handleProfileUpdate(e) {
            e.preventDefault();
            
            const updatedData = {
                name: document.getElementById('profileName').value,
                phone: document.getElementById('profilePhone').value,
                city: document.getElementById('profileCity').value
            };
            
            try {
                // Try to update on server first (for development)
                const response = await fetch('/api/profile', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(updatedData),
                    credentials: 'include'
                });
                
                if (response.ok) {
                    console.log('Profile updated on server');
                    const updatedUser = await response.json();
                    currentUser = { ...currentUser, ...updatedUser };
                } else {
                    console.log('Server update failed, updating locally only');
                    // Update locally even if server fails
                    currentUser.name = updatedData.name;
                    currentUser.phone = updatedData.phone;
                    currentUser.city = updatedData.city;
                }
            } catch (error) {
                console.error('Profile update error:', error);
                // Update locally even if server fails
                currentUser.name = updatedData.name;
                currentUser.phone = updatedData.phone;
                currentUser.city = updatedData.city;
            }
            
            // Always update localStorage
            localStorage.setItem('rentrobe_user', JSON.stringify(currentUser));
            showAlert('profileSuccess');
            updateAuthUI();
        }

        function loadMyItems() {
            if (!currentUser) return;
            
            const myItems = items.filter(item => item.owner && item.owner.name === currentUser.name);
            const container = document.getElementById('myItemsContainer');
            
            if (myItems.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--gray-600);">You haven\'t listed any items yet.</p>';
            } else {
                container.innerHTML = '<div class="items-grid"></div>';
                renderItemsInContainer(myItems, container.querySelector('.items-grid'), true);
            }
        }

        async function deleteItem(itemId) {
            if (!currentUser) {
                showAlert('Please log in to delete items');
                return;
            }

            // Confirm deletion
            if (!confirm('Are you sure you want to delete this item? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`/api/items/${itemId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                if (response.ok) {
                    // Remove item from local arrays
                    items = items.filter(item => item.id !== itemId);
                    filteredItems = filteredItems.filter(item => item.id !== itemId);
                    
                    // Reload the My Items section
                    loadMyItems();
                    
                    // Reload browse section to reflect changes
                    if (document.getElementById('browse').classList.contains('active')) {
                        renderAllItems();
                    }
                    
                    showAlert('Item deleted successfully');
                } else {
                    const errorData = await response.json();
                    showAlert(errorData.error || 'Failed to delete item');
                }
            } catch (error) {
                console.error('Error deleting item:', error);
                showAlert('Failed to delete item. Please try again.');
            }
        }


        async function updateRentalStatus(rentalId, status, btn, ev) {
            if (ev && ev.stopPropagation) ev.stopPropagation();
            // Disable buttons of this rental row while processing
            if (btn) {
                btn.disabled = true;
                const btnContainer = btn.parentElement;
                if (btnContainer) {
                    const buttons = btnContainer.querySelectorAll('button');
                    buttons.forEach(b => { b.disabled = true; b.textContent = 'Updating...'; });
                    const sp = btnContainer.querySelector('.spinner');
                    if (sp) sp.style.display = 'inline-block';
                }
            }
            try {
                const resp = await fetch(`/api/rentals/${rentalId}/status`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ status })
                });
                if (resp.ok) {
                    // Refresh items
                    await loadItems();
                } else {
                    const data = await resp.json().catch(() => ({}));
                    if (btn) {
                        const btnContainer = btn.parentElement;
                        if (btnContainer) {
                            const err = btnContainer.querySelector('.item-size');
                            if (err) {
                                err.textContent = data.error || 'Failed to update';
                                err.style.display = 'inline-block';
                            }
                        }
                    }
                }
            } catch (e) {
                // Re-enable on error
                if (btn) {
                    const btnContainer = btn.parentElement;
                    if (btnContainer) {
                        const buttons = btnContainer.querySelectorAll('button');
                        buttons.forEach(b => { b.disabled = false; b.textContent = b.textContent.includes('Approve') ? 'Approve' : 'Decline'; });
                        const sp = btnContainer.querySelector('.spinner');
                        if (sp) sp.style.display = 'none';
                    } else {
                        btn.disabled = false;
                    }
                }
            }
        }

        // Utility functions
        function showAlert(alertId) {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.style.display = 'block';
                setTimeout(() => alert.style.display = 'none', 3000);
            }
        }

        function showSpinner(spinnerId) {
            const spinner = document.getElementById(spinnerId);
            if (spinner) spinner.style.display = 'inline-block';
        }

        function hideSpinner(spinnerId) {
            const spinner = document.getElementById(spinnerId);
            if (spinner) spinner.style.display = 'none';
        }

        // FAQ functionality
        function initializeFAQ() {
            const faqItems = document.querySelectorAll('.faq-item');
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                
                question.addEventListener('click', () => {
                    const isActive = item.classList.contains('active');
                    
                    // Close all other FAQ items
                    faqItems.forEach(otherItem => {
                        if (otherItem !== item) {
                            otherItem.classList.remove('active');
                        }
                    });
                    
                    // Toggle current item
                    if (isActive) {
                        item.classList.remove('active');
                    } else {
                        item.classList.add('active');
                    }
                });
            });
        }

        // Contact form functionality
        function initializeContactForm() {
            const contactForm = document.querySelector('.contact-form');
            
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Get form data
                    const formData = new FormData(contactForm);
                    const data = Object.fromEntries(formData);
                    
                    // Show success message (in a real app, you'd send this to a server)
                    alert('Thank you for your message! We\'ll get back to you within 24 hours.');
                    
                    // Reset form
                    contactForm.reset();
                });
            }
        }

        // Initialize FAQ and contact form when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeFAQ();
            initializeContactForm();
        });

        // Password toggle function
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const toggle = input.parentElement.querySelector('.password-toggle');
            const eyeIcon = toggle.querySelector('.eye-icon');
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.classList.add('visible');
                // Change to eye-slash icon
                eyeIcon.innerHTML = `
                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                    <line x1="1" y1="1" x2="23" y2="23"/>
                `;
            } else {
                input.type = 'password';
                toggle.classList.remove('visible');
                // Change back to eye icon
                eyeIcon.innerHTML = `
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                `;
            }
        }

        // Export for debugging
        window.RentrobeApp = {
            currentUser: () => currentUser,
            items: () => items,
            showPage,
            showModal
        };
    </script>
</body>
</html>